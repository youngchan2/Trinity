[
  {
    "ir_id": 1747,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23305215835571289,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1748,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23411712646484376,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1749,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.22947839736938477,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1750,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23073856353759767,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1751,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23489536285400392,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1752,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23294015884399413,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1753,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2337708854675293,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1754,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23113727569580078,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1755,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23979007720947265,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1756,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23655296325683595,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1757,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23857152938842774,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1758,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23848960876464845,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1759,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23849983215332032,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1763,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23170047760009765,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1764,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2366054344177246,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1765,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23353408813476562,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1766,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23965696334838868,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1770,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23375871658325195,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1771,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23856128692626954,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1775,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23118751525878906,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1779,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2311577606201172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1780,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2351308822631836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1781,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2390732765197754,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1785,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23534591674804686,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1786,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2313212776184082,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1787,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2308403205871582,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1788,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.22748159408569335,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1789,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23362464904785157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1790,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23327743530273437,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1791,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.235468807220459,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1792,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2345471954345703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1793,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2347315216064453,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1797,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22944768905639648,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1798,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23255039215087892,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1799,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2298556709289551,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1800,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23604223251342774,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1804,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23088127136230469,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1805,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23395263671875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1809,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22742015838623048,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1813,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2272665596008301,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1814,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23305215835571289,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1815,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2370252799987793,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1819,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2329292869567871,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1820,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))))",
    "execution_time_ms": 0.2369228744506836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1821,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23658496856689454,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1822,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23908351898193358,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1823,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2388572883605957,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1824,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23877567291259766,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1828,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23096319198608398,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1829,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23609344482421876,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1833,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23034879684448242,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1837,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2276860809326172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1838,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.24548351287841796,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1839,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24607744216918945,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1840,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2454732894897461,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1844,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.238602237701416,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1848,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2330624008178711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1852,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23548927307128906,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1856,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2347929573059082,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1859,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23477119445800781,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1864,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22883327484130858,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1868,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23284736633300782,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1872,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23005184173583984,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1876,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23597055435180664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1881,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23021568298339845,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1885,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2347110366821289,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1890,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22768640518188477,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1895,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22818815231323242,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1896,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23654239654541015,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1900,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23096319198608398,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1904,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23647232055664064,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1909,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23445503234863282,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1910,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23813119888305664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1911,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2372915267944336,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1912,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23432191848754882,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1913,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2411520004272461,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1914,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.24029184341430665,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1915,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2431385612487793,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1916,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24272895812988282,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1917,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24240127563476563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1921,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23724031448364258,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1922,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24090496063232422,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1923,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23762943267822265,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1924,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2428927993774414,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1928,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2372915267944336,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1929,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.24135679244995117,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1933,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23431135177612306,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1937,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23414783477783202,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1938,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.24232959747314453,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1939,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.24625152587890625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1943,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24250335693359376,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1944,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))))",
    "execution_time_ms": 0.24369152069091796,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1945,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24387584686279296,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1946,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2464067268371582,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1947,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24594432830810548,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1948,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24597503662109374,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1952,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2391449546813965,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1953,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.24417280197143554,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1957,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23822208404541015,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1961,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23570432662963867,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1962,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2518716812133789,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1963,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.25160703659057615,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1964,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2501529693603516,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1968,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24349632263183593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1972,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2404044723510742,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1976,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24331264495849608,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1980,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.242872314453125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1983,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2431180763244629,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1988,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2363596725463867,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1992,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24122367858886717,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1996,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23794687271118165,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2000,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24414207458496093,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2005,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23794687271118165,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2009,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2429747200012207,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2014,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23560192108154296,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2019,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23535615921020508,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2020,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.24259584426879882,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2024,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23824384689331055,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2028,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24259584426879882,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2033,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23835647583007813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2034,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))))",
    "execution_time_ms": 0.23831552505493164,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2035,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2371993637084961,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2036,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.24074239730834962,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2037,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24128511428833008,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2038,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24092544555664064,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2042,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23428096771240234,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2043,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23609344482421876,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2047,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23357440948486327,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2051,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23002111434936523,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2052,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.24219648361206056,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2053,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2432921600341797,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2054,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2430361557006836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2058,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23633920669555664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2062,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23576576232910157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2066,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2394316864013672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2070,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23785631179809572,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2073,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23802879333496094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2078,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23166976928710936,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2082,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23656448364257812,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2086,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2309324836730957,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2090,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23620607376098632,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2095,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23370752334594727,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2099,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23399423599243163,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2104,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23002111434936523,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2109,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22999008178710936,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2110,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2386636734008789,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2114,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23336959838867188,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2118,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23835647583007813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2123,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23361536026000976,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2127,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23792640686035157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2128,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2434867286682129,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2129,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24328191757202147,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2130,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2435264015197754,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2131,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) dummy)) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24352767944335937,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2132,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2432921600341797,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2135,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23882688522338869,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2136,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))) (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))))))))))))",
    "execution_time_ms": 0.24356864929199218,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2140,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2430361557006836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2144,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24258560180664063,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2147,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24136703491210937,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2152,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23564287185668945,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2156,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23828479766845703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2161,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23374847412109376,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2166,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23177215576171875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2170,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2474393653869629,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2174,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24738815307617187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2177,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24724479675292968,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2182,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2383359909057617,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2187,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2371583938598633,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2192,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23957536697387696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2197,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2388275146484375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2201,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2386636734008789,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2206,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2330828857421875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2211,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23691200256347655,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2216,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23364608764648437,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2221,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23853055953979493,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2226,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23355392456054688,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2231,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23787519454956055,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2236,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23157760620117188,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2241,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23179264068603517,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2245,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23413759231567383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2250,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2284441566467285,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2255,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23373823165893554,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2260,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2286284828186035,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2305,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2330419158935547,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2306,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23377920150756837,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2307,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.230830078125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2308,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23053312301635742,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2309,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23598079681396483,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2310,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23407583236694335,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2311,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23361536026000976,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2312,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2309119987487793,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2313,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2391756820678711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2314,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2364739227294922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2315,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23880704879760742,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2316,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23803903579711913,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2317,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23817216873168945,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2321,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23190528869628907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2322,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2367487907409668,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2323,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23386112213134766,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2324,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2394713592529297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2328,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23356416702270508,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2329,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2384806442260742,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2333,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2307379150390625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2337,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23107616424560548,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2338,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23558143615722657,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2339,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23928831100463868,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2343,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23568384170532228,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2344,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2305023956298828,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2345,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23165887832641602,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2346,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2279827117919922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2347,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2332159996032715,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2348,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23253984451293946,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2349,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2348441505432129,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2350,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2348643112182617,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2351,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2348748779296875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2355,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23038976669311523,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2356,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2331648063659668,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2357,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2304400062561035,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2358,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23578624725341796,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2362,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23117664337158203,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2363,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23386112213134766,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2367,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22785024642944335,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2371,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22782976150512696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2372,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23227392196655272,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2373,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23621631622314454,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2377,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2327039909362793,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2378,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2367897605895996,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2379,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23714815139770506,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2380,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23887872695922852,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2381,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23880704879760742,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2382,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2388172721862793,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2386,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23187456130981446,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2387,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23633920669555664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2391,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2307686424255371,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2395,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2284432029724121,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2396,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24559616088867187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2397,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24532991409301758,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2398,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24552448272705077,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2402,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23851007461547852,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2406,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23367584228515625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2410,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2352128028869629,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2414,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2351411247253418,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2417,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23468032836914063,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2422,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22924287796020507,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2426,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23345151901245118,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2430,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23038143157958985,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2434,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23644159317016603,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2439,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2311884880065918,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2443,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2352627182006836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2448,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22847488403320312,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2453,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2284441566467285,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2454,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23813119888305664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2458,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.231014404296875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2462,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23789567947387696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2467,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23186431884765624,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2507,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23819263458251952,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2508,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23805952072143555,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2509,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23449600219726563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2510,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2411622428894043,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2511,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2404761505126953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2512,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2427903938293457,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2513,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2428620719909668,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2514,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2429030418395996,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2518,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2372915267944336,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2519,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24121343612670898,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2520,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23782400131225587,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2521,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2433945655822754,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2525,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23780351638793945,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2526,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2407321548461914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2530,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23453567504882813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2534,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23436288833618163,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2535,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2427494430541992,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2536,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24797183990478516,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2540,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24312831878662108,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2541,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.24407039642333983,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2542,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24357887268066405,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2543,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2465382385253906,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2544,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24619007110595703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2545,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24607744216918945,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2549,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23945215225219726,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2550,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24444927215576173,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2554,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23842815399169923,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2558,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23622655868530273,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2559,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2514227294921875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2560,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2514329528808594,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2561,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2513203239440918,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2565,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24401920318603515,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2569,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2408755111694336,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2573,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24396799087524415,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2577,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2429337692260742,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2580,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.243056640625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2585,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23693248748779297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2589,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24085376739501954,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2593,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23789567947387696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2597,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24460287094116212,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2602,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.238602237701416,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2606,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24337631225585937,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2611,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23639039993286132,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2616,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2364313507080078,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2617,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2420345687866211,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2621,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23802879333496094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2625,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24202239990234375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2630,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23813119888305664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2665,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.23795551300048828,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2666,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23779327392578126,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2667,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24009727478027343,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2668,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23969791412353517,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2669,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23997440338134765,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2673,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23540735244750977,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2674,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24059904098510743,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2678,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23450624465942382,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2682,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23160831451416017,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2683,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2410495948791504,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2684,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24139776229858398,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2685,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2413363265991211,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2689,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.238919677734375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2693,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23769088745117187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2697,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23779327392578126,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2701,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23704511642456055,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2704,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.237587833404541,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2709,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23376895904541015,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2713,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23775232315063477,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2717,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23590911865234376,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2721,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24014848709106446,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2726,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2350592041015625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2730,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23846912384033203,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2735,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23192575454711914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2740,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23145471572875975,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2741,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24118272781372072,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2745,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23580671310424806,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2749,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24129535675048827,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2754,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23574527740478515,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2834,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2407219123840332,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2835,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2433737564086914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2836,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2427494430541992,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2837,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2427084732055664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2838,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2430054473876953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2839,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24247295379638673,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2842,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2388172721862793,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2843,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))) (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))))))))))",
    "execution_time_ms": 0.24262496948242188,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2847,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2430361557006836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2851,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24266752243041992,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2854,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24200191497802734,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2859,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2366054344177246,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2863,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24024063110351562,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2868,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23557119369506835,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2873,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2346598434448242,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2877,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24670080184936524,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2881,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24563711166381835,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2884,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24556543350219726,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2889,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24189855575561522,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2894,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23879680633544922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2899,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24132608413696288,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2904,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23954431533813478,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2908,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23916479110717773,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2913,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2367180824279785,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2918,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23856128692626954,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2923,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23672767639160155,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2928,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24001535415649414,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2933,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2351411247253418,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2938,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23986175537109375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2943,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2347724723815918,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2948,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23480287551879883,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2966,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23652223587036134,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2971,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2306559944152832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2976,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2366873550415039,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2981,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23089151382446288,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3282,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23302143096923827,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3283,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23354368209838866,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3284,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23023616790771484,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3285,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23012351989746094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3286,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23580671310424806,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3287,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23427072525024414,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3288,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23344127655029298,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3289,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23128063201904298,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3290,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2390015983581543,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3291,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23628799438476564,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3292,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2385919952392578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3293,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23804767608642577,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3294,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23802879333496094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3298,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2313420867919922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3299,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23621631622314454,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3300,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23366655349731447,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3301,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2393190383911133,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3305,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23351295471191405,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3306,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23868415832519532,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3310,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2306867218017578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3314,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2309222412109375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3315,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23548864364624023,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3316,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2390719985961914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3320,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23577600479125976,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3321,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23014400482177735,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3322,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2312486457824707,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3323,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22803455352783203,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3324,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23365631103515624,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3325,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23234527587890624,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3326,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2352332878112793,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3327,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2347724723815918,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3328,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23454591751098633,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3332,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22984703063964843,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3333,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23318527221679688,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3334,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23045024871826172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3335,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23558143615722657,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3339,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23119871139526368,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3340,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23391231536865234,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3344,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22811647415161132,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3348,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22813695907592774,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3349,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23220224380493165,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3350,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23621631622314454,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3354,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23239679336547853,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3355,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23666688919067383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3356,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2371504020690918,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3357,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2389107131958008,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3358,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2385919952392578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3359,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23838720321655274,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3363,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23154687881469727,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3364,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23630847930908203,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3368,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2308095932006836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3372,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22802431106567383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3373,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24580223083496094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3374,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2453811264038086,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3375,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24636415481567384,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3379,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2389504051208496,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3383,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23363424301147462,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3387,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2351513671875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3391,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2350182342529297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3394,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23476224899291992,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3399,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22874080657958984,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3403,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2331443214416504,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3407,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23024639129638672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3411,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23578655242919921,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3416,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2306559944152832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3420,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23457792282104492,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3425,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22839296340942383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3430,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22809600830078125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3431,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23799808502197264,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3435,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2304819107055664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3439,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23640064239501954,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3444,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2313420867919922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3572,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23828479766845703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3573,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23792640686035157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3574,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23433216094970702,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3575,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24186880111694337,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3576,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24078399658203126,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3577,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24272895812988282,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3578,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24241151809692382,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3579,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24266752243041992,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3583,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2371891212463379,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3584,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24122367858886717,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3585,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23787519454956055,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3586,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2431078338623047,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3590,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23778303146362303,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3591,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2414182472229004,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3595,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23444480895996095,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3599,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23470239639282225,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3600,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24248319625854492,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3601,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24800256729125977,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3605,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2430259132385254,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3606,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.24456192016601563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3607,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2438960075378418,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3608,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24631296157836913,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3609,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24576000213623048,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3610,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24617984771728516,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3614,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2391961669921875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3615,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24431615829467773,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3619,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23818239212036132,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3623,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23615488052368164,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3624,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.25222143173217776,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3625,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2512691116333008,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3626,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.25116672515869143,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3630,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24394752502441405,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3634,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2408755111694336,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3638,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24391647338867187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3642,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2429952049255371,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3645,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24285184860229492,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3650,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23663616180419922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3654,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2414793586730957,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3658,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2383359909057617,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3662,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2447667121887207,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3667,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23867328643798827,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3671,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2430054473876953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3676,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2364313507080078,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3681,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23609344482421876,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3682,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24230911254882812,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3686,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23788543701171874,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3690,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24198144912719727,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3695,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23848960876464845,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3808,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.23826431274414062,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3809,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23834623336791994,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3810,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24001535415649414,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3811,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24049663543701172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3812,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24026111602783204,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3816,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23554048538208008,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3817,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24037376403808594,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3821,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2348441505432129,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3825,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23197696685791017,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3826,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24151039123535156,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3827,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24044544219970704,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3828,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2409164810180664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3832,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2391654396057129,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3836,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23817216873168945,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3840,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23762943267822265,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3844,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23750656127929687,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3847,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23716768264770507,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3852,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2331135940551758,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3856,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23769088745117187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3860,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23610368728637696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3864,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23991296768188478,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3869,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2349056053161621,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3873,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2389084815979004,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3878,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2314137649536133,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3883,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23176191329956056,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3884,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24103935241699218,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3888,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23593984603881835,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3892,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2411212730407715,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3897,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2365238380432129,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4115,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24068096160888672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4116,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24283136367797853,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4117,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24212480545043946,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4118,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24269920349121094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4119,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24294399261474608,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4120,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) dummy)) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24236032485961914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4123,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2388889694213867,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4124,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))) (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))))))))))",
    "execution_time_ms": 0.24240127563476563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4128,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2426265525817871,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4132,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24189952850341798,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4135,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24222719192504882,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4140,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.236759033203125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4144,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24030208587646484,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4149,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2344028854370117,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4154,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23409664154052734,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4158,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24616960525512696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4162,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24625055313110353,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4165,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24564767837524415,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4170,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24208383560180663,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4175,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23854080200195313,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4180,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24107967376708983,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4185,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23956480026245117,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4189,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23930879592895507,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4194,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23662591934204102,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4199,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2385919952392578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4204,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23629823684692383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4209,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23982080459594726,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4214,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2347929573059082,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4219,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23970687866210938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4224,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2345574378967285,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4229,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23463903427124022,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4343,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23604223251342774,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4348,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23010303497314452,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4353,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23617536544799805,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 4358,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23116863250732422,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5244,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2329395294189453,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5245,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23360511779785156,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5246,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23043071746826171,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5247,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23033855438232423,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5248,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23532543182373047,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5249,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23439359664916992,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5250,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.233175048828125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5251,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23102624893188475,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5252,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2393600082397461,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5253,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23629823684692383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5254,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23857152938842774,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5255,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23823360443115235,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5256,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23812095642089845,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5260,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2315158462524414,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5261,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23651424407958985,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5262,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2338617515563965,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5263,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23935935974121095,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5267,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2331648063659668,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5268,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23814144134521484,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5272,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23106592178344726,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5276,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23106559753417968,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5277,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23562240600585938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5278,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23930976867675782,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5282,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23555072784423828,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5283,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2304409599304199,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5284,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23160831451416017,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5285,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22773759841918945,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5286,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23300960540771484,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5287,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23205984115600586,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5288,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2351308822631836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5289,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2345267105102539,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5290,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2347007942199707,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5294,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22962175369262694,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5295,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2330624008178711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5296,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23031808853149413,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5297,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23558143615722657,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5301,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23121919631958007,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5302,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23366655349731447,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5306,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22805503845214845,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5310,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2281884765625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5311,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.232488956451416,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5312,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23565311431884767,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5316,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2321811294555664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5317,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2367487907409668,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5318,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2370252799987793,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5319,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2391449546813965,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5320,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2383964729309082,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5321,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23856128692626954,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5325,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23177087783813477,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5326,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23648256301879883,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5330,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23075904846191406,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5334,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22800384521484374,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5335,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2454220771789551,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5336,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24558591842651367,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5337,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24555519104003906,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5341,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23857152938842774,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5345,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2334003257751465,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5349,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23511903762817382,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5353,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.234967041015625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5356,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2346598434448242,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5361,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22897632598876952,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5365,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23254016876220704,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5369,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23006208419799803,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5373,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23613439559936522,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5378,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23089151382446288,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5382,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23451648712158202,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5387,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22829055786132812,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5392,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22841344833374022,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5393,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23642112731933593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5397,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23147520065307617,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5401,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23626752853393554,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5406,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2304409599304199,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5681,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2386934471130371,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5682,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23785472869873048,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5683,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23435264587402344,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5684,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24197311401367189,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5685,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24041471481323243,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5686,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2428108787536621,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5687,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24239103317260743,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5688,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24308704376220702,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5692,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23672832489013673,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5693,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24166400909423827,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5694,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23806976318359374,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5695,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24324031829833984,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5699,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23735296249389648,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5700,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2409164810180664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5704,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23445503234863282,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5708,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23451488494873046,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5709,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2427494430541992,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5710,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24754175186157226,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5714,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24271808624267577,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5715,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24474624633789063,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5716,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24342527389526367,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5717,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24630271911621093,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5718,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24587263107299806,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5719,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24594432830810548,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5723,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24010751724243165,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5724,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24446815490722656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5728,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23821311950683594,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5732,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23561119079589843,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5733,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.25169919967651366,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5734,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2518732833862305,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5735,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.25155584335327147,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5739,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24386560440063476,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5743,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24151039123535156,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5747,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24413183212280273,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5751,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2433945655822754,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5754,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.243189754486084,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5759,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23691263198852539,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5763,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24137664794921876,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5767,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23786495208740235,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5771,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24467456817626954,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5776,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2388479995727539,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5780,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2431488037109375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5785,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23608224868774413,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5790,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23595008850097657,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5791,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24255615234375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5795,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23842815399169923,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5799,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24257375717163085,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 5804,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23848960876464845,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6049,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23855104446411132,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6050,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23827455520629884,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6051,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24029407501220704,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6052,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2404761505126953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6053,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24035327911376952,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6057,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23598079681396483,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6058,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24020992279052733,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6062,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23525375366210938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6066,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23190528869628907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6067,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24106943130493164,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6068,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24045503616333008,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6069,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24034271240234376,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6073,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23966720581054687,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6077,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23828479766845703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6081,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23781375885009765,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6085,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2375801658630371,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6088,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23783424377441406,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6093,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23355392456054688,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6097,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23811071395874023,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6101,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23626655578613281,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6105,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2404761505126953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6110,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23530624389648438,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6114,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2391756820678711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6119,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23205888748168946,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6124,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23185407638549804,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6125,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24147968292236327,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6129,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23606271743774415,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6133,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24169471740722656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6138,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23662591934204102,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6593,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24003583908081055,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6594,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24328224182128907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6595,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24260608673095704,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6596,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2428927993774414,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6597,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) dummy)) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24276832580566407,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6598,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24261632919311524,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6601,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23858175277709961,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6602,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))) (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))))))))",
    "execution_time_ms": 0.2427903938293457,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6606,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2427187156677246,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6610,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24222719192504882,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6613,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24253440856933595,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6618,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23673856735229493,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6622,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24016895294189453,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6627,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2347110366821289,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6632,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23434240341186524,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6636,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24635391235351561,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6640,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24614912033081054,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6643,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24572927474975587,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6648,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24158208847045898,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6653,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2389606475830078,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6658,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24056831359863282,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6663,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23942144393920897,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6667,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2393292808532715,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6672,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2368614387512207,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6677,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23827455520629884,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6682,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23649152755737304,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6687,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24009727478027343,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6692,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2349772834777832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6697,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23960575103759765,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6702,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23442432403564453,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6707,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23446527481079102,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7034,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.236759033203125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7039,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.231125431060791,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7044,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23663616180419922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7049,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2306150436401367,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7230,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.603276824951172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7231,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.605877685546875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7232,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6022119140625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7233,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.602293701171875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7234,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6074546813964843,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7235,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6052940368652344,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7236,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6060108947753906,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7237,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6018829345703125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7238,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6129638671875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7239,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6066969299316407,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7240,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.610946502685547,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7241,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.611304931640625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7242,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.610577850341797,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7246,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6036146545410157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7247,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.605560302734375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7248,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.601300506591797,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7249,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6115705871582031,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7253,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6058460998535156,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7254,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6099020385742187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7258,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6025590515136718,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7262,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6022015380859376,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7263,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6049766540527344,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7264,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.609205780029297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7268,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6038809204101563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7269,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.5999591064453125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7270,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.601802215576172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7271,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.5981056213378906,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7272,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.60427001953125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7273,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6050892639160157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7274,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6060313415527343,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7275,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.604423065185547,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7276,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6049862670898438,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7280,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6018841552734375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7281,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6028877258300782,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7282,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.5998463439941406,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7283,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.606051483154297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7287,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.601669158935547,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7288,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6040345764160155,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7292,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.5956883239746094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7296,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.5968051147460938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7297,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6029286193847656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7298,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.607863311767578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7302,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.603225555419922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7303,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 1.6072090148925782,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7304,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6052963256835937,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7305,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.609687042236328,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7306,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6091238403320312,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7307,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.609820098876953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7311,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6009004211425781,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7312,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6069119262695313,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7316,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6027641296386719,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7320,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.5994265747070313,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7321,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6159642028808594,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7322,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.614202880859375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7323,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.61438720703125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7327,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6112332153320312,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7331,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6057650756835937,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7335,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.605367431640625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7339,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6058470153808593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7342,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.60611328125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7347,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.5980645751953124,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7351,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6036752319335938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7355,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.598719940185547,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7359,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6065434265136718,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7364,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.601914520263672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7368,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6056632995605469,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7373,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.5988429260253907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7378,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.5997132873535156,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7379,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6023849487304687,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7383,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (load (tensor C) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.5965705871582032,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7387,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.60321533203125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7392,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_perturb) (/ (+ (load (tensor C) (index (elem n) fulltile (tile p))) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.598351287841797,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7667,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6107008361816406,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7668,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6117861938476563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7669,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6074546813964843,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7670,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.614376983642578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7671,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.61617919921875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7672,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6192819213867187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7673,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6148582458496095,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7674,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6153797912597656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7678,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6102400207519532,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7679,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6147552490234376,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7680,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6083045959472657,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7681,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6166297912597656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7685,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6117674255371093,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7686,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.615687713623047,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7690,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6084774780273436,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7694,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6092262268066406,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7695,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6135061645507813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7696,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6192819213867187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7700,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6121958923339843,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7701,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 1.61870849609375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7702,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.618585662841797,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7703,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.621422119140625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7704,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.618882293701172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7705,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.617459259033203,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7709,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6132301330566405,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7710,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6169984436035156,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7714,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6104039001464843,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7718,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6094400024414062,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7719,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.621657257080078,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7720,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6227824401855468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7721,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6219955444335938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7725,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6213401794433593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7729,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.61617919921875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7733,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6179302978515624,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7737,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6161383056640626,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7740,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.61691650390625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7745,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.610118408203125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7749,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6142643737792968,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7753,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6091340637207032,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7757,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6180429077148437,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7762,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.61154052734375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7766,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6151551818847656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7771,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6100250244140626,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7776,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6088166809082032,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7777,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.612779541015625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7781,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6058572387695313,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7785,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.613465576171875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7790,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.605939178466797,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8035,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 1.6123289489746093,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8036,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6110694885253907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8037,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6136396789550782,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8038,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6131890869140626,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8039,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6128102111816407,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8043,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6050688171386718,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8044,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6096051025390625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8048,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6051609802246094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8052,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6019456481933594,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8053,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6178790283203126,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8054,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6180531311035156,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8055,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6189543151855468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8059,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6112742614746094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8063,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6097279357910157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8067,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6099839782714844,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8071,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6091136169433593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8074,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6092364501953125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8079,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6049766540527344,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8083,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.608028106689453,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8087,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6005734252929686,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8091,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6088986206054687,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8096,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6051405334472657,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8100,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.608038330078125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8105,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6008396911621094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8110,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6015257263183593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8111,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.60785400390625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8115,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6047923278808593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8119,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6087551879882813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8124,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp,C_exp_perturb) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6051303100585939,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8579,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6091232299804688,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8580,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6135475158691406,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8581,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6143463134765625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8582,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6151040649414063,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8583,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.615257568359375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8584,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6132608032226563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8587,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6084786987304687,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8588,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))) (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))))))))",
    "execution_time_ms": 1.614571533203125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8592,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.61154052734375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8596,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6117759704589845,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8599,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6112844848632812,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8604,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6070352172851563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8608,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6061949157714843,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8613,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6051405334472657,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8618,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6006655883789063,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8622,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6185650634765625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8626,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6168243408203125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8629,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6174899291992189,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8634,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.612236785888672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8639,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.609318389892578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8644,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6069734191894531,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8649,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.60542724609375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8653,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)) (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p))) dummy)) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6048214721679688,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8658,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6029696655273438,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8663,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.609390106201172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8668,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6030514526367188,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8673,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6054579162597655,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8678,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x 1 (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile))) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq dummy (seq (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6027647399902343,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8683,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div_perturb) (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (output C_out) (rsum (load (tensor C_div_perturb) (index (elem n) fulltile (tile p))) 1) (index (elem n) (tile p)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.604884490966797,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8688,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (load (input noise) (index (elem n) fulltile (tile p)))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6007066345214844,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8693,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))) (seq (store (tensor C_perturb) (/ (+ (load (input noise) (index (elem n) fulltile (tile p))) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 1.5) (index (elem n) fulltile (tile p))) (seq (store (tensor C_exp,C_exp_perturb) (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum,C_sum_perturb) (+ (rsum (exp (load (tensor C,C_perturb) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum,C_sum_perturb) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)) (seq dummy (store (output C_out) (rsum (/ (load (tensor C_exp_perturb) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum_perturb) (index (elem n) fulltile)) 2)) 1) (index (elem n) (tile p))))))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.602099151611328,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  }
]