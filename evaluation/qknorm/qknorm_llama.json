[
  {
    "ir_id": 1302,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.22385663986206056,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1303,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))))",
    "execution_time_ms": 0.21905408859252928,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1304,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21979135513305664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1306,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.21926912307739257,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1308,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.21915647506713867,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1310,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2208563232421875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1312,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2209382438659668,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1313,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2228144073486328,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1315,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2186342430114746,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1316,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21898239135742187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1318,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2187366485595703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1320,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21554176330566407,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1322,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21784576416015625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1324,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21808128356933593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1326,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.21915647506713867,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1328,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.222238712310791,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1330,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2266009521484375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1331,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2190336036682129,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1333,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.21496831893920898,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1334,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2168627166748047,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1336,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2148454475402832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1338,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2150912094116211,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1340,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21808128356933593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1342,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21801984786987305,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1343,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22044672012329103,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1345,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21450752258300781,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1346,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2148236846923828,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1348,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21450752258300781,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1350,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.20930400848388672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1352,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2127052879333496,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1354,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2125619125366211,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1356,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2125004768371582,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1358,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21582847595214844,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1360,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22822912216186522,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1380,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22391807556152343,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1381,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.22023296356201172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1382,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22046720504760742,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1384,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22008832931518554,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1386,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22009855270385742,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1388,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22183935165405275,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1390,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22164480209350587,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1391,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22369279861450195,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1393,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22000640869140625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1394,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21989376068115235,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1396,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21992448806762696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1398,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2157263946533203,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1400,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2184396743774414,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1402,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2185523223876953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1404,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21924863815307616,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1406,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22250463485717772,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1408,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22651903152465822,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1420,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21925888061523438,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1422,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21445632934570313,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1423,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21764095306396483,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1425,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21431295394897462,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1427,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21597183227539063,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1429,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21981184005737306,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1431,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21976064682006835,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1438,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22218751907348633,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1440,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21595136642456056,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1441,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2162892723083496,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1443,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21611520767211914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1451,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21020832061767578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1453,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2127052879333496,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1455,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2127564811706543,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1463,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21337087631225585,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1465,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21719007492065429,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1467,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2270412826538086,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1559,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22384639739990234,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1560,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21983232498168945,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1561,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2203647994995117,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1563,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21997568130493164,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1565,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22010879516601561,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1567,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22189056396484375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1569,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22168575286865233,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1570,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22367168426513673,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1572,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22017023086547852,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1573,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22000640869140625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1575,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21998592376708984,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1577,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21548032760620117,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1579,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2185113525390625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1581,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2185113525390625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1583,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2191654396057129,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1585,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22252384185791016,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1587,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22651903152465822,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1634,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21927936553955077,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1636,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2140991973876953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1637,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21753856658935547,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1639,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21429248809814452,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1641,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21576576232910155,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1643,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2200979232788086,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1645,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22007808685302735,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1674,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22194175720214843,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1676,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21576704025268556,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1677,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21673984527587892,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1679,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21605247497558594,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1705,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21012479782104493,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1707,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2129305648803711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1709,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21286016464233398,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1732,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21347328186035155,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1734,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2170470428466797,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 1736,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22717439651489257,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2012,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22354944229125975,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2013,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21994495391845703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2014,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2204364776611328,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2016,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2203647994995117,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2018,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22002527236938477,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2020,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22133920669555665,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2022,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22156415939331053,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2023,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22362112045288085,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2025,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21960704803466796,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2026,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21979135513305664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2028,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21985279083251952,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2030,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21559295654296876,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2032,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2185113525390625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2034,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21841920852661134,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2036,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21944223403930663,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2038,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22246400833129884,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2040,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22229984283447266,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2156,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21929983139038087,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2158,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21434368133544923,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2159,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21748735427856444,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2161,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2142617607116699,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2163,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21553152084350585,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2165,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22033376693725587,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2167,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21992448806762696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2246,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22227104187011718,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2248,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2158793640136719,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2249,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21633024215698243,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2251,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21582847595214844,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2321,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21004287719726564,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2323,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21323776245117188,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2325,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2129305648803711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2381,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21353408813476563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2383,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21748735427856444,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 2385,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21746688842773437,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3067,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22397951126098634,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3068,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21996543884277345,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3069,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22020095825195313,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3071,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22030336380004883,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3073,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.220130558013916,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3075,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22145023345947265,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3077,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22167552947998048,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3078,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22343679428100585,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3080,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22017023086547852,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3081,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21995359420776367,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3083,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21984256744384767,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3085,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21547136306762696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3087,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2187161636352539,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3089,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2184499168395996,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3091,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21944320678710938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3093,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22237184524536133,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3095,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22258687973022462,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3329,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21926912307739257,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3331,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21401599884033204,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3332,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21783552169799805,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3334,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2144767951965332,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3336,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21573631286621095,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3338,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21974016189575196,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3340,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21968896865844725,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3518,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22159263610839844,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3520,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21582912445068358,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3521,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21641216278076172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3523,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21587968826293946,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3690,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.20989952087402344,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3692,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2125619125366211,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3694,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2127052879333496,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3816,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21358591079711914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3818,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2169343948364258,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 3820,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2269273567199707,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6770,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6578970336914063,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6771,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6536883544921874,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6772,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6571597290039062,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6774,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.654200897216797,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6776,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6550297546386719,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6778,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.654036407470703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6780,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6533401489257813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6781,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6567193603515624,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6783,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.65465087890625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6784,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6563507080078126,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6786,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.654466552734375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6788,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6554086303710938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6790,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6530841064453126,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6792,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6542413330078125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6794,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6552857971191406,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6796,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6542723083496094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 6798,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.660385284423828,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7227,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6528378295898438,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7229,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6541183471679688,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7230,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6537484741210937,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7232,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6542413330078125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7234,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6515379333496094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7236,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6551014709472656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7238,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6550297546386719,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7571,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6579385375976563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7573,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6538931274414062,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7574,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6523469543457032,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7576,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6544371032714844,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7915,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.687697296142578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7917,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6943624877929688,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 7919,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6939418029785156,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8254,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6911769104003906,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8256,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6966233825683594,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 8258,
    "ir_expression": "(ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6947404479980468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9612,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.22590335845947265,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9613,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))))",
    "execution_time_ms": 0.22121471405029297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9614,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.222740478515625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9616,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.22149120330810546,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9618,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.22142816543579102,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9620,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22335487365722656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9622,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22365184783935546,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9623,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2265395164489746,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9625,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.22131711959838868,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9626,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22184959411621094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9628,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22124544143676758,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9630,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22012863159179688,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9632,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22330368041992188,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9634,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22403072357177733,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9636,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.22153215408325194,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9638,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2241324806213379,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9640,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.23040000915527345,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9641,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22106111526489258,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9643,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.21609472274780273,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9644,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21932031631469726,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9646,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21565439224243163,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9648,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21795839309692383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9650,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22121471405029297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9652,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2209075164794922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9653,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.222607364654541,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9655,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21692352294921874,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9656,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2172313690185547,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9658,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21703680038452147,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9660,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2110259246826172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9662,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2143846321105957,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9664,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21532672882080078,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9666,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21503999710083008,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9668,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21788671493530273,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9670,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21822463989257812,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9690,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2268057632446289,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9691,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.2227097511291504,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9692,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22385663986206056,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9694,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22244352340698242,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9696,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22228992462158204,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9698,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22401023864746095,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9700,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22450176239013672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9701,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.227194881439209,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9703,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2229043197631836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9704,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2227916717529297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9706,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2225766372680664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9708,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2204774475097656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9710,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22457344055175782,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9712,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22381568908691407,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9714,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22230016708374023,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9716,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22572032928466798,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9718,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22561792373657227,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9730,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22198272705078126,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9732,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.216760311126709,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9733,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2201487922668457,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9735,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2169139289855957,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9737,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2184499168395996,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9739,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22158336639404297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9741,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22184959411621094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9748,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22467584609985353,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9750,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21891071319580077,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9751,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.219289608001709,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9753,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21857280731201173,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9761,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21004287719726564,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9763,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21576704025268556,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9765,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21569536209106446,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9773,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21644287109375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9775,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21998592376708984,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9777,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21997568130493164,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9869,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2262835121154785,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9870,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2224947166442871,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9871,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22363136291503907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9873,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22243328094482423,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9875,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22246400833129884,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9877,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22404096603393556,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9879,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22432767868041992,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9880,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22728704452514648,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9882,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2224947166442871,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9883,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22238208770751952,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9885,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22254592895507813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9887,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2206515121459961,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9889,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22397951126098634,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9891,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22397951126098634,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9893,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2224947166442871,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9895,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2257811164855957,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9897,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22595584869384766,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9944,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22163455963134765,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9946,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21671775817871095,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9947,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21987327575683593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9949,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2169638442993164,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9951,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21810079574584962,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9953,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22218751907348633,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9955,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22187007904052736,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9984,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22451200485229492,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9986,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2188492774963379,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9987,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21926912307739257,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 9989,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2186240005493164,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10015,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21045248031616212,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10017,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21554176330566407,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10019,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21566463470458985,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10042,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21650400161743164,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10044,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22005760192871093,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10046,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22924224853515626,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10322,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22743040084838867,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10323,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22258687973022462,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10324,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2491289520263672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10326,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2226278305053711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10328,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22244352340698242,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10330,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22465471267700196,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10332,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.25009151458740236,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10333,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22720512390136718,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10335,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22264768600463866,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10336,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22260608673095703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10338,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22195199966430665,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10340,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2204262351989746,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10342,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24561664581298828,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10344,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2238256072998047,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10346,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22240255355834962,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10348,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24844287872314452,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10350,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.230328311920166,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10466,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22191104888916016,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10468,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21702655792236328,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10469,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.242359676361084,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10471,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2168320083618164,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10473,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21825471878051758,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10475,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22187007904052736,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10477,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22118400573730468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10556,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22449151992797853,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10558,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24611839294433593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10559,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24608768463134767,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10561,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24606719970703125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10631,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21049343109130858,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10633,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21550079345703124,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10635,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21525503158569337,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10691,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21695487976074218,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10693,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21991424560546874,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 10695,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22017023086547852,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11377,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2536652755737305,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11378,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24809471130371094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11379,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24907743453979492,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11381,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24804191589355468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11383,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2472857666015625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11385,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.25021440505981446,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11387,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.25023487091064456,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11388,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.25236480712890624,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11390,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24678400039672851,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11391,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2475212860107422,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11393,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2467225646972656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11395,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24219648361206056,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11397,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24576000213623048,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11399,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.24497152328491212,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11401,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2453811264038086,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11403,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24877056121826172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11405,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2591436767578125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11639,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.248668155670166,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11641,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2407935905456543,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11642,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24252416610717772,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11644,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2411315155029297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11646,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24400896072387696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11648,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2470809555053711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11650,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2470911979675293,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11828,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2538895988464355,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11830,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24622079849243164,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11831,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.24531967163085938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 11833,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24578048706054687,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 12000,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23415807723999024,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 12002,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.24249343872070311,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 12004,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2428927993774414,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 12126,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24976383209228514,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 12128,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2536140823364258,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 12130,
    "ir_expression": "(seq (ploop 0 4096 tile_n n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.26445728302001953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15713,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22449151992797853,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15714,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.21990400314331054,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15715,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22131711959838868,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15717,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21939199447631835,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15719,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21946367263793945,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15721,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.222423038482666,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15723,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22201343536376952,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15724,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2246963119506836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15726,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.220262393951416,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15727,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22023168563842774,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15729,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22021120071411132,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15731,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21790719985961915,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15733,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21977088928222657,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15735,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22030176162719728,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15737,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21909503936767577,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15739,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22363136291503907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15741,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2290278434753418,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15742,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21958623886108397,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15744,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21411840438842775,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15745,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2186240005493164,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15747,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21371904373168946,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15749,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21646272659301757,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15751,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21857280731201173,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15753,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2212351989746094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15754,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22284288406372071,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15756,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21522335052490235,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15757,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2153875160217285,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15759,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21707775115966796,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15761,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2107084846496582,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15763,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21262336730957032,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15765,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21246976852416993,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15767,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2149068832397461,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15769,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21652416229248048,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15771,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21727231979370118,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15791,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22533119201660157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15792,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2223206329345703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15793,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22203392028808594,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15795,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2223513603210449,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15797,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2205900764465332,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15799,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2228416061401367,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15801,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2228940773010254,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15802,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2253107261657715,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15804,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2205072021484375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15805,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22227968215942384,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15807,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21988319396972655,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15809,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21781408309936523,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15811,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22233087539672852,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15813,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22209535598754881,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15815,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2205183982849121,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15817,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22558719635009766,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15819,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.230512638092041,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15831,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21993471145629884,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15833,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2165247917175293,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15834,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22014976501464845,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15836,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21420032501220704,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15838,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21716991424560547,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15840,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21992448806762696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15842,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22009855270385742,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15849,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2227199935913086,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15851,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21947391510009764,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15852,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21684223175048828,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15854,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21750656127929688,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15862,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.20971519470214844,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15864,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21299200057983397,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15866,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2124595260620117,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15874,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21640064239501952,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15876,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21615615844726563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15878,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22592512130737305,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15970,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2269491195678711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15971,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21979135513305664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15972,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22224895477294923,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15974,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2205183982849121,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15976,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2207027244567871,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15978,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2241535949707031,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15980,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2226278305053711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15981,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22547456741333008,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15983,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21994464874267577,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15984,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2208255958557129,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15986,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2228531265258789,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15988,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21779455184936525,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15990,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22180864334106445,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15992,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2214089584350586,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15994,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22063104629516603,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15996,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22402048110961914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 15998,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22397951126098634,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16045,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22034431457519532,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16047,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2165247917175293,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16048,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21802911758422852,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16050,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2144767951965332,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16052,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21796735763549804,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16054,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21760000228881837,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16056,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22010879516601561,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16085,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22277088165283204,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16087,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21771263122558593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16088,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21742591857910157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16090,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21706752777099608,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16116,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.20981760025024415,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16118,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21211135864257813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16120,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21262176513671874,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16143,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21265407562255859,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16145,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21651456832885743,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16147,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2162892723083496,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16423,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.25350080490112303,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16424,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24788896560668947,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16425,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23982080459594726,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16427,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23946239471435546,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16429,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24002559661865233,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16431,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.25013248443603514,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16433,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24280063629150392,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16434,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24433664321899415,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16436,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23988224029541017,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16437,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23946176528930663,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16439,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24033279418945314,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16441,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2330112075805664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16443,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23659519195556641,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16445,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.237076473236084,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16447,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2451763153076172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16449,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2409676742553711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16451,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24952831268310546,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16567,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23915519714355468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16569,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23347135543823241,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16570,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23434240341186524,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16572,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2407935905456543,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16574,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23436288833618163,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16576,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23777280807495116,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16578,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.23751583099365234,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16657,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24421375274658202,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16659,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24608768463134767,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16660,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.23847808837890624,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16662,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23627775192260742,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16732,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22031360626220703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16734,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.24266752243041992,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16736,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) dummy)) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.24268800735473633,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16792,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2365337562561035,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16794,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2404761505126953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 16796,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.24978431701660156,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19472,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22479743957519532,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19473,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22093664169311522,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19474,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22092800140380858,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19476,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2213471984863281,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19478,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2194838333129883,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19480,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22227968215942384,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19482,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22218751907348633,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19483,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2247987174987793,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19485,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21954559326171874,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19486,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22008832931518554,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19488,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21954559326171874,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19490,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21839872360229493,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19492,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21962688446044923,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19494,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21959680557250977,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19496,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22111232757568358,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19498,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22366207122802734,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19500,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2228633689880371,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19501,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21999616622924806,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19503,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2144767951965332,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19504,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21751808166503905,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19506,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2142617607116699,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19508,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21564416885375975,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19510,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2187775993347168,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19512,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21835775375366212,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19513,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22146047592163087,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19515,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21568351745605469,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19516,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21597183227539063,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19518,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21539840698242188,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19520,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.20990976333618164,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19522,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2126028823852539,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19524,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2123161506652832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19526,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21309440612792968,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19528,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2163814353942871,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19530,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22580223083496093,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19550,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.23164928436279297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19551,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22778879165649413,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19552,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22807552337646483,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19554,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22787071228027345,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19556,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22650880813598634,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19558,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2288640022277832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19560,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2285158348083496,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19561,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2311884880065918,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19563,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2269593620300293,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19564,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22704000473022462,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19566,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22707168579101564,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19568,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22440895080566406,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19570,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22563840866088866,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19572,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2262118339538574,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19574,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22776832580566406,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19576,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22972415924072265,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19578,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22933408737182617,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19590,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22803455352783203,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19592,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2241535949707031,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19593,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22478847503662108,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19595,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22421503067016602,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19597,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22497280120849608,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19599,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2262620735168457,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19601,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22631423950195312,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19608,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2290380859375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19610,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22418432235717772,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19611,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22450176239013672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19613,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22434816360473633,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19621,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21149696350097658,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19623,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21538816452026366,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19625,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21529600143432617,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19633,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22336511611938475,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19635,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2280124855041504,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19637,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22734848022460938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19729,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2448793601989746,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19730,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2408857536315918,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19731,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24121343612670898,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19733,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24107007980346679,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19735,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24118272781372072,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19737,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24461280822753906,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19739,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24400768280029297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19740,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2452684783935547,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19742,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24023040771484375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19743,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2408857536315918,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19745,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24053760528564452,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19747,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.235100154876709,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19749,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23790592193603516,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19751,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.23804927825927735,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19753,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23883647918701173,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19755,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24169471740722656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19757,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24175615310668946,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19804,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24018943786621094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19806,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2352332878112793,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19807,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2354070472717285,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19809,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23482368469238282,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19811,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23577600479125976,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19813,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23921663284301758,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19815,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.23863296508789061,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19844,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24457216262817383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19846,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23857152938842774,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19847,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.23800832748413087,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19849,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23812095642089845,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19875,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2279622459411621,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19877,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.23242752075195314,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19879,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.23204864501953126,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19902,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24031232833862304,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19904,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24319999694824218,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 19906,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.25319360733032226,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22232,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22583295822143554,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22233,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22118400573730468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22234,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22166528701782226,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22236,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22092800140380858,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22238,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22001663208007813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22240,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22236160278320313,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22242,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2227814483642578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22243,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22452224731445314,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22245,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22032384872436522,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22246,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22110048294067383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22248,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22040576934814454,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22250,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21751808166503905,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22252,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21981184005737306,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22254,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2203340721130371,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22256,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22363136291503907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22258,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22387712478637695,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22260,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2288640022277832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22261,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2206719970703125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22263,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21520383834838866,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22264,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21814271926879883,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22266,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21496831893920898,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22268,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21800960540771486,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22270,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21971967697143555,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22272,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21999616622924806,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22273,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22255615234375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22275,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2169753646850586,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22276,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21742591857910157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22278,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21744640350341796,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22280,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.20904960632324218,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22282,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21335039138793946,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22284,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21307264328002928,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22286,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21378047943115233,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22288,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2177123260498047,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22290,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21738496780395508,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22310,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23413759231567383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22311,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22994943618774413,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22312,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23040000915527345,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22314,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.23031808853149413,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22316,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22973440170288087,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22318,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23205888748168946,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22320,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23152639389038085,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22321,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23339008331298827,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22323,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22990848541259765,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22324,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23019519805908203,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22326,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23006208419799803,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22328,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22623231887817383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22330,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22852544784545897,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22332,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22848512649536132,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22334,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2328678321838379,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22336,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2325606346130371,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22338,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23826431274414062,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22350,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23131135940551759,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22352,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22761472702026367,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22353,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22763519287109374,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22355,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22749183654785157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22357,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22777856826782228,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22359,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2290995216369629,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22361,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22887424468994141,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22368,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23091072082519531,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22370,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2269081687927246,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22371,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22651903152465822,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22373,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22654975891113283,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22381,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2165657615661621,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22383,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21943296432495119,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22385,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2192076873779297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22393,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.23010303497314452,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22395,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23377920150756837,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 22397,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.24230911254882812,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24974,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.22601728439331054,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24975,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))))",
    "execution_time_ms": 0.2210508728027344,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24976,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2227097511291504,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24978,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.22138879776000978,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24980,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.22159360885620116,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24982,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22378400802612305,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24984,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22362112045288085,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24985,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22590463638305663,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24987,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.22160383224487304,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24988,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22175647735595702,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24990,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2210406494140625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24992,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22012928009033203,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24994,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22369279861450195,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24996,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2234060859680176,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 24998,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.22121471405029297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25000,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2247270393371582,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25002,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2305014419555664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25003,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22088672637939452,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25005,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.21641216278076172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25006,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21932031631469726,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25008,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21649408340454102,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25010,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21767168045043944,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25012,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22122495651245117,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25014,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22081535339355468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25015,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22245376586914062,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25017,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21706752777099608,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25018,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21695487976074218,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25020,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21681087493896484,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25022,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2105241584777832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25024,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2145689582824707,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25026,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2146201515197754,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25028,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.21529439926147462,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25030,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21824512481689454,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25032,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22989824295043945,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25052,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2269798469543457,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25053,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))))",
    "execution_time_ms": 0.222423038482666,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25054,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22346752166748046,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25056,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22236160278320313,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25058,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22195199966430665,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25060,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22411264419555665,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25062,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22365184783935546,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25063,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2268057632446289,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25065,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.2224630355834961,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25066,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2223513603210449,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25068,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22204416275024413,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25070,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22098943710327149,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25072,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22384639739990234,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25074,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22331392288208007,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25076,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22185983657836914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25078,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22593503952026367,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25080,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22585344314575195,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25092,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22204256057739258,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25094,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.216779842376709,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25095,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21986303329467774,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25097,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2167193603515625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25099,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21832704544067383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25101,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22170623779296875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25103,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22167552947998048,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25110,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22410240173339843,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25112,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21847040176391602,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25113,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21946367263793945,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25115,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21890047073364258,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25123,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.20988927841186522,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25125,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21512191772460937,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25127,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21497856140136717,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25135,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2165452766418457,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25137,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21980159759521484,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25139,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21999488830566405,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25231,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22666240692138673,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25232,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))))",
    "execution_time_ms": 0.22219776153564452,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25233,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22379520416259766,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25235,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2221558380126953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25237,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22187007904052736,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25239,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22418432235717772,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25241,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22376447677612304,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25242,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2269798469543457,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25244,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.22192127227783204,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25245,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2228326416015625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25247,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22206464767456055,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25249,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22001663208007813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25251,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22370304107666017,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25253,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22336511611938475,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25255,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.2228121566772461,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25257,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22575103759765625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25259,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2310963249206543,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25306,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22149120330810546,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25308,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.21741567611694335,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25309,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21954559326171874,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25311,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2166374397277832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25313,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21835775375366212,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25315,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22157312393188477,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25317,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22131711959838868,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25346,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2243379211425781,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25348,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2188185691833496,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25349,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21906431198120116,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25351,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2190438461303711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25377,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.20968448638916015,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25379,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21517152786254884,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25381,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21545984268188476,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25404,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.21614591598510743,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25406,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22012928009033203,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25408,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22918079376220704,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25684,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22644735336303712,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25685,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))))",
    "execution_time_ms": 0.24796159744262694,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25686,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22374399185180663,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25688,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24788991928100587,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25690,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22217727661132813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25692,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24972160339355468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25694,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.25028608322143553,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25695,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2269491195678711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25697,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24657920837402345,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25698,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2223513603210449,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25700,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22245376586914062,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25702,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24133567810058593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25704,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22394880294799804,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25706,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22362079620361328,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25708,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.22236160278320313,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25710,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24838144302368165,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25712,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22561792373657227,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25828,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22158336639404297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25830,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2165657615661621,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25831,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24224767684936524,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25833,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21688320159912108,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25835,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21783424377441407,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25837,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22170623779296875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25839,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22158336639404297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25918,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.25324480056762694,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25920,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21934080123901367,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25921,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21900287628173828,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25923,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24585216522216796,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25993,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21032960891723632,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25995,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21522432327270508,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 25997,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21577728271484375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26053,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.21597183227539063,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26055,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21953535079956055,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26057,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21981184005737306,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26739,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2530406379699707,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26740,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.24767488479614258,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26741,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24849407196044923,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26743,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24806400299072265,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26745,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24712095260620118,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26747,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24995840072631836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26749,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2500403213500977,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26750,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.25182207107543947,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26752,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.24637439727783203,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26753,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24738815307617187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26755,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24605695724487306,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26757,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2412540817260742,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26759,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24272895812988282,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26761,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2452684783935547,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26763,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2447769546508789,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26765,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24855552673339842,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 26767,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.25854976654052736,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27001,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24853504180908204,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27003,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2407219123840332,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27004,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24225791931152343,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27006,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2407935905456543,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27008,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24373247146606444,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27010,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24702976226806642,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27012,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.24717311859130858,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27190,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.25357311248779296,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27192,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24583168029785157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27193,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.24607744216918945,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27195,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.24597503662109374,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27362,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.23403520584106446,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27364,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.24298496246337892,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27366,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.24250368118286134,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27488,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.24978431701660156,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27490,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2536038398742676,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 27492,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.25374719619750974,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29668,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22467584609985353,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29669,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))))",
    "execution_time_ms": 0.2207027244567871,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29670,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2205900764465332,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29672,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22055936813354493,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29674,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2190224075317383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29676,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2211942481994629,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29678,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22169599533081055,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29679,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22468608856201172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29681,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2205183982849121,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29682,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21974016189575196,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29684,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22007808685302735,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29686,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2165657615661621,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29688,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21940223693847657,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29690,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21979135513305664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29692,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22345727920532227,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29694,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2232815933227539,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29696,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22820863723754883,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29697,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21954559326171874,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29699,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.2144767951965332,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29700,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21776384353637696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29702,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21434368133544923,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29704,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21742591857910157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29706,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21969919204711913,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29708,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21971967697143555,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29709,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22169599533081055,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29711,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21659648895263672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29712,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21651456832885743,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29714,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.216760311126709,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29716,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.20894720077514647,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29718,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21251071929931642,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29720,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21189632415771484,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29722,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21211135864257813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29724,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21557247161865234,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 29726,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2248192024230957,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30899,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6536268615722656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30900,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 1.6526438903808593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30901,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.652797393798828,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30903,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6511077880859375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30905,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6508416748046875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30907,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6543743896484375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30909,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6535244750976563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30910,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.652613067626953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30912,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6504934692382813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30913,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6509849548339843,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30915,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6503910827636719,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30917,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6471653747558594,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30919,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6494898986816406,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30921,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6493466186523438,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30923,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6496127319335938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30925,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.65032958984375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 30927,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6562892150878907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31388,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22542335510253905,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31389,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22180864334106445,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31390,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22233087539672852,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31392,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22151168823242187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31394,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21799936294555664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31396,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22237184524536133,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31398,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22228992462158204,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31399,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.224583683013916,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31401,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22149120330810546,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31402,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2210406494140625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31404,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2206924819946289,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31406,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21735359191894532,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31408,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2185932731628418,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31410,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2186240005493164,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31412,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2204364776611328,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31414,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22338560104370117,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31416,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2230169677734375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31809,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2250649642944336,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31810,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22138879776000978,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31811,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22201343536376952,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31813,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22156288146972655,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31815,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22074367523193358,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31817,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22251520156860352,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31819,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2229248046875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31820,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22457344055175782,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31822,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22156288146972655,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31823,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22168575286865233,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31825,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22094783782958985,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31827,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21728256225585937,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31829,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21879808425903322,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31831,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2183782386779785,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31833,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2206208038330078,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31835,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2226483154296875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 31837,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22789119720458983,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32040,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22567935943603515,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32041,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22152191162109375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32042,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2223923110961914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32044,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22190080642700194,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32046,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22074367523193358,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32048,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22265855789184572,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32050,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.222238712310791,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32051,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22484991073608399,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32053,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2209791946411133,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32054,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22139904022216797,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32056,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2206604766845703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32058,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2149888038635254,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32060,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2185830307006836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32062,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21923839569091796,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32064,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2211635208129883,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32066,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22311935424804688,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32068,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22836223602294922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32155,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22521856307983398,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32156,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22213632583618165,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32157,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22191104888916016,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32159,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22124479293823243,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32161,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22081375122070312,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32163,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22284288406372071,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32165,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22205440521240236,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32166,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22464511871337892,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32168,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2209177589416504,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32169,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22108095169067382,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32171,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22055936813354493,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32173,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21731327056884767,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32175,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21883903503417967,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32177,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21839872360229493,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32179,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2208768081665039,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32181,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22331392288208007,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32183,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22785024642944335,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32203,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2253107261657715,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32204,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))))",
    "execution_time_ms": 0.22076416015625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32205,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22148096084594726,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32207,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22081535339355468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32209,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22007808685302735,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32211,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22185983657836914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32213,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22200319290161133,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32214,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22410240173339843,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32216,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21992448806762696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32217,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22012928009033203,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32219,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2207334327697754,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32221,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2165350341796875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32223,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21799936294555664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32225,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21801984786987305,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32227,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21995519638061523,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32229,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22204416275024413,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 32231,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22731775283813477,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33211,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.654456329345703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33213,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6522950744628906,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33214,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.654886474609375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33216,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.652500457763672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33218,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6528684997558594,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33220,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6531251525878907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33222,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6540663146972656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33563,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2221561622619629,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33565,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2173747253417969,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33566,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22060031890869142,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33568,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21730272293090822,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33570,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21962751388549806,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33572,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22023168563842774,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33574,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22078304290771483,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33883,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22191104888916016,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33885,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21774335861206054,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33886,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2202521514892578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33888,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21825536727905273,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33890,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22000640869140625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33892,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2207027244567871,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 33894,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22055936813354493,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34048,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22210464477539063,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34050,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21750783920288086,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34051,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2206822395324707,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34053,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21770240783691405,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34055,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21992448806762696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34057,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22074367523193358,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34059,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22019071578979493,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34124,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22184959411621094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34126,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21749759674072267,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34127,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22038528442382813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34129,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21746688842773437,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34131,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2194825553894043,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34133,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2206617546081543,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34135,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.220262393951416,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34152,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22063039779663085,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34154,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.21594112396240234,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34155,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21916671752929687,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34157,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21553152084350585,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34159,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2186956787109375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34161,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2195136070251465,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34163,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2187775993347168,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34164,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22549407958984374,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34165,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22064128875732422,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34166,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22375360488891602,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34168,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22155263900756836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34170,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22291391372680663,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34172,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22372352600097656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34174,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22371328353881836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34180,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22589279174804688,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34181,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.2210304069519043,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34182,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22402048110961914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34184,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22137855529785155,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34186,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22331232070922852,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34188,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22399999618530272,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34190,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2241535949707031,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34217,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22591487884521486,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34218,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22158336639404297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34219,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22355968475341798,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34221,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2209791946411133,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34223,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2233126449584961,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34225,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22397951126098634,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34227,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2243788719177246,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34306,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22548479080200196,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34307,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22154239654541016,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34308,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22425472259521484,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34310,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22201311111450195,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34312,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2230681610107422,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34314,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2243379211425781,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34316,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22432767868041992,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34498,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22594560623168947,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34499,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 0.22159360885620116,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34500,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22364160537719727,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34502,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2210201644897461,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34504,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22356992721557617,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34506,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22452224731445314,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 34508,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22426624298095704,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35149,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6548658752441405,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35150,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))))",
    "execution_time_ms": 1.6500531005859376,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35151,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6532070922851563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35153,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.649397735595703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35155,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6518655395507813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35157,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.652551727294922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35159,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6534835815429687,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35301,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.65607421875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35303,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6518963623046874,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35304,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6521932983398437,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35306,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6513331604003907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35628,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2227916717529297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35630,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21832704544067383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35631,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2185318374633789,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 35633,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2187468719482422,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36025,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22336511611938475,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36027,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2188800048828125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36028,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2168627166748047,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36030,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21817344665527344,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36203,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.222740478515625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36205,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21812160491943358,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36206,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21828607559204102,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36208,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21810176849365234,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36275,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.222740478515625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36277,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21789695739746093,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36278,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2185318374633789,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36280,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21833728790283202,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36299,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22055936813354493,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36301,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2165043258666992,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36302,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21604352951049804,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36304,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21634048461914063,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36305,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22599679946899415,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36307,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2209075164794922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36308,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22125568389892578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36310,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2211020851135254,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36311,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2262623977661133,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36312,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22046720504760742,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36313,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22138879776000978,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36315,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22155231475830078,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36316,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22013952255249022,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36318,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2150912094116211,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36319,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21610496520996095,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36321,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2146918487548828,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36329,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2268057632446289,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36331,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22074367523193358,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36332,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22191104888916016,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36334,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22150144577026368,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36335,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22663167953491212,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36336,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22156288146972655,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36337,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22189056396484375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36339,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22236160278320313,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36345,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2220332717895508,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36347,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2169139289855957,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36348,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21732351303100586,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36350,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21703680038452147,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36385,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22604799270629883,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36387,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2206812858581543,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36388,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22287359237670898,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36390,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22181856155395507,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36391,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2272972869873047,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36392,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2226790428161621,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36393,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22261760711669923,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36395,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2225663948059082,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36415,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22291456222534178,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36417,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21736448287963867,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36418,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21814144134521485,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36420,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2173030471801758,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36527,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2271232032775879,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36529,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22230016708374023,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36530,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22255615234375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36532,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22240255355834962,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36533,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22764543533325196,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36534,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22160255432128906,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36535,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22360063552856446,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36537,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22196096420288086,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36584,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.222740478515625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36586,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21776384353637696,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36587,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2184396743774414,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36589,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21768192291259766,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36859,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22715391159057619,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36861,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22179840087890626,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36862,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22305791854858398,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36864,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22256479263305665,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36865,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22715391159057619,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36866,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22240255355834962,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36867,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22337535858154298,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36869,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22175743103027343,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36962,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22323200225830078,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36964,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21777408599853515,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36965,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21733375549316405,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 36967,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21738496780395508,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38124,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6496435546875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38126,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.645127716064453,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38127,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6454655456542968,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38129,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6443801879882813,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38130,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6526950073242188,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38131,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6461004638671874,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38132,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6474111938476563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38134,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.648179168701172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38302,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6460287475585937,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38304,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.6395878601074219,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38305,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6405503845214844,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38307,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.64136962890625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38543,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22459264755249023,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38544,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p dummy)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2211635208129883,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38545,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22449056625366212,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38547,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p dummy))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22122495651245117,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38548,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2211942481994629,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38550,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p dummy))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2148147201538086,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38551,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2227507209777832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38553,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (sloop 0 1040 tile_p p dummy)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21617664337158204,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38556,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22599679946899415,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38557,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p dummy))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2223513603210449,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38558,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22564863204956054,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38560,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p dummy)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22208511352539062,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38563,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2223103904724121,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38565,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p dummy)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21797887802124025,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38569,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22215679168701172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38571,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (sloop 0 1040 tile_p p dummy))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21804031372070312,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38583,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2252390480041504,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38584,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p dummy)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22220800399780274,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38585,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22486015319824218,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38587,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p dummy))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22190080642700194,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38594,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22246400833129884,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38596,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p dummy))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21699583053588867,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38607,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.222238712310791,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38609,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (sloop 0 1040 tile_p p dummy)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21800895690917968,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38644,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2251468849182129,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38645,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p dummy))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2226278305053711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38646,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2249625587463379,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38648,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p dummy)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22024192810058593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38661,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22295551300048827,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38663,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p dummy)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2173747253417969,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38687,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.222740478515625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38689,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (sloop 0 1040 tile_p p dummy))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21825536727905273,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38771,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22503423690795898,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38772,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p dummy)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22211584091186523,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38773,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2248089599609375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38775,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p dummy))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22143999099731446,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38796,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22222688674926758,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38798,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p dummy))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21808128356933593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38843,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2220944023132324,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 38845,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (sloop 0 1040 tile_p p dummy)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21848064422607422,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 39127,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6535244750976563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 39128,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p dummy))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6483219909667968,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 39129,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6536985778808593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 39131,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p dummy)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.645015106201172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 39162,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6532992553710937,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 39164,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p dummy)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6399769592285156,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 39219,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))))) (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6576205444335939,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 39221,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (sloop 0 1040 tile_p p dummy))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6507391357421874,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40337,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22045696258544922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40338,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22432767868041992,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40339,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22027263641357422,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40341,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22081535339355468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40343,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22170623779296875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40345,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22098943710327149,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40346,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21937152862548828,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40347,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22337535858154298,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40349,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21970943450927735,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40351,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21922815322875977,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40353,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21914560317993165,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40355,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21799936294555664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40357,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22302719116210937,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40359,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2209177589416504,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40360,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21785600662231444,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40361,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22017023086547852,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40363,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21576704025268556,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40365,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21489664077758788,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40367,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2184908866882324,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40369,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21648384094238282,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40370,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2165238380432129,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40371,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22160383224487304,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40373,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21582847595214844,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40375,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21626880645751953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40377,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21240703582763673,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40379,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21005311965942383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40381,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21572608947753907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40383,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21213184356689452,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40399,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22142976760864258,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40400,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22606847763061524,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40401,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22210559844970704,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40403,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2225971221923828,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40405,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22236160278320313,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40407,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22118400573730468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40408,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2209177589416504,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40409,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22487903594970704,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40411,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2209791946411133,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40413,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22156288146972655,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40415,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21972896575927733,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40417,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21838848114013673,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40419,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22359039306640624,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40421,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21993440628051758,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40431,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2184601593017578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40432,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2206096076965332,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40434,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21625856399536134,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40436,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21634048461914063,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40438,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.218920955657959,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40440,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21778400421142577,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40447,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21823488235473631,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40448,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2225551986694336,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40450,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2185523223876953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40452,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21833728790283202,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40458,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2128895950317383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40460,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21027839660644532,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40466,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2167692756652832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40468,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2127347183227539,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40541,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22160383224487304,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40542,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22603776931762695,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40543,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22167552947998048,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40545,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2210918426513672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40547,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2226380729675293,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40549,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22122495651245117,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40550,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22131711959838868,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40551,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22497280120849608,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40553,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22088703155517578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40555,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2208665657043457,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40557,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21932992935180665,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40559,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21833663940429687,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40561,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22371328353881836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40563,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22003711700439454,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40601,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21808128356933593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40602,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22063104629516603,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40604,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2166783905029297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40606,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21622783660888673,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40608,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2168627166748047,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40610,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21744640350341796,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40637,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21829631805419922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40638,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22265855789184572,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40640,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2185523223876953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40642,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21839872360229493,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40662,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21312416076660157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40664,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.20946943283081054,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40680,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2166374397277832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40682,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21315584182739258,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40900,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2209382438659668,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40901,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22578176498413086,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40902,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22168447494506835,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40904,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22192031860351563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40906,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2225356864929199,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40908,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2207334327697754,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40909,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22098943710327149,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40910,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22540288925170898,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40912,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22143999099731446,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40914,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22108160018920897,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40916,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2195644760131836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40918,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2186444854736328,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40920,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22328256607055663,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 40922,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22003711700439454,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41015,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21824512481689454,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41016,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2209791946411133,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41018,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2162892723083496,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41020,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2161356735229492,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41022,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2195555114746094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41024,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21755903244018554,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41096,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2184294319152832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41097,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22021120071411132,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41099,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21828607559204102,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41101,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2183065605163574,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41156,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21334016799926758,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41158,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.20970495223999022,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41196,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21648256301879884,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41198,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.212541446685791,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41737,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22148096084594726,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41738,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22562816619873047,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41739,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22125568389892578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41741,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22153215408325194,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41743,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22265855789184572,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41745,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22117376327514648,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41746,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22111232757568358,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41747,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22575103759765625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41749,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22139904022216797,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41751,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22106111526489258,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41753,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21972991943359374,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41755,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2186739158630371,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41757,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22349824905395507,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41759,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2201804733276367,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41946,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21863359451293946,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41947,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22044672012329103,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41949,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21617504119873046,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41951,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2167193603515625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41953,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21949440002441406,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 41955,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2184908866882324,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 42116,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21790719985961915,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 42117,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2226380729675293,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 42119,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21841920852661134,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 42121,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21918720245361328,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 42254,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2131046485900879,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 42256,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21004287719726564,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 42338,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21707775115966796,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 42340,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21265247344970703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 44679,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6554690551757814,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 44680,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6529612731933594,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 44681,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6543128967285157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 44683,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6552549743652343,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 44685,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6586752319335938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 44687,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6539840698242188,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 44688,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6524493408203125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 44689,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6572927856445312,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 44691,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.652183074951172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 44693,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.65001220703125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 44695,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.653922576904297,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 44697,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6511386108398438,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 44699,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.658603515625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 44701,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6536781311035156,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 45043,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6526336669921875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 45044,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6578253173828126,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 45046,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6450755310058593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 45048,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6483941650390626,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 45050,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.655398406982422,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 45052,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6508416748046875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 45338,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6532070922851563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 45339,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6549375915527345,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 45341,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6486810302734376,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 45343,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6487628173828126,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 45648,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6999203491210937,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 45650,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6916787719726563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 45874,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.697433624267578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 45876,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6972186279296875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47213,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22443008422851562,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47214,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22023168563842774,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47215,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) dummy)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22044672012329103,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47217,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22027263641357422,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47219,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2221670341491699,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47221,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21941247940063477,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47223,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22136831283569336,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47224,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22393856048583985,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47226,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21932992935180665,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47227,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) dummy))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22014944076538087,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47229,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21945344924926757,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47231,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22019071578979493,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47233,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21650272369384765,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47235,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21940095901489257,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47237,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2250956726074219,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47239,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22081535339355468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47241,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22207487106323243,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47242,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22062015533447266,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47244,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21533695220947266,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47245,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21773311614990234,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47247,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21543935775756837,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47249,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21838848114013673,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47251,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21598207473754882,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47253,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) dummy))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2186342430114746,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47254,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) dummy))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22111232757568358,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47256,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21558271408081053,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47257,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21608448028564453,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47259,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21618688583374024,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47261,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21568511962890624,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47263,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.20911104202270508,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47265,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21313535690307617,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47267,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.218920955657959,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47269,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21301151275634767,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47271,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) dummy))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21634048461914063,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47291,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) dummy)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22573055267333986,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47292,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22175743103027343,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47293,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) dummy))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2209382438659668,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47295,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22189056396484375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47297,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22366207122802734,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47299,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2205183982849121,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47301,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22236000061035155,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47302,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2253107261657715,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47304,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22120447158813478,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47305,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22166528701782226,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47307,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22150144577026368,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47309,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21967872619628906,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47311,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21810176849365234,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47313,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21956480026245118,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47315,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2248703956604004,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47317,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22081535339355468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47319,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22388736724853517,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47331,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22117376327514648,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47333,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21597183227539063,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47334,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21872480392456053,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47336,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21629951477050782,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47338,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2203340721130371,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47340,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21761024475097657,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47342,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2187059211730957,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47349,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.222740478515625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47351,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21832704544067383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47352,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21800960540771486,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47354,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2171187210083008,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47362,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21536767959594727,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47364,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21008384704589844,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47366,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21310367584228515,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47374,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21898239135742187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47376,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2126848030090332,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47378,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21642240524291992,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47470,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22543359756469727,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47471,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22172672271728516,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47472,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22115327835083007,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47474,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22221824645996094,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47476,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22324224472045898,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47478,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2209791946411133,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47480,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) dummy)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2228223991394043,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47481,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2253107261657715,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47483,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22187007904052736,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47484,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2210099220275879,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47486,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22128639221191407,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47488,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2207539176940918,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47490,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2182655906677246,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47492,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21965791702270507,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47494,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2247782325744629,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47496,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21999616622924806,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47498,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) dummy)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22323200225830078,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47545,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2209075164794922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47547,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2168012809753418,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47548,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2186649513244629,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47550,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21603328704833985,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47552,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22117376327514648,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47554,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21856224060058593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47556,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) dummy))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.219105281829834,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47585,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22250431060791015,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47587,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21702655792236328,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47588,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) dummy)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2186342430114746,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47590,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21688320159912108,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47616,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21537792205810546,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47618,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.20967424392700196,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47620,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21285888671875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47643,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21914560317993165,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47645,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21369855880737304,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47647,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21659648895263672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47923,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22549407958984374,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47924,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22105056762695313,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47925,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21898143768310546,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47927,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22147071838378907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47929,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22343679428100585,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47931,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2210406494140625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47933,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22226943969726562,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47934,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22600671768188477,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47936,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22214656829833984,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47937,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22125568389892578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47939,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22163455963134765,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47941,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21968896865844725,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47943,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21839872360229493,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47945,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.219718074798584,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47947,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2232524871826172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47949,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22030336380004883,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 47951,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22388736724853517,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48067,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) dummy))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.220599365234375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48069,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2158278465270996,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48070,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2184601593017578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48072,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21603328704833985,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48074,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21914623260498048,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48076,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21761024475097657,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48078,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21935007095336914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48157,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) dummy)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22224895477294923,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48159,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21708799362182618,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48160,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21811071395874024,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48162,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21775360107421876,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48232,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21304319381713868,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48234,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21003263473510742,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48236,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21322751998901368,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48292,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21900287628173828,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48294,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21210111618041994,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48296,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2165452766418457,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48978,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22535167694091796,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48979,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22157312393188477,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48980,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) dummy)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2212851142883301,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48982,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22143999099731446,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48984,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22337535858154298,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48986,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2210918426513672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48988,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2225356864929199,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48989,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22603776931762695,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48991,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22154239654541016,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48992,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22092800140380858,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48994,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2212950325012207,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48996,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22086528778076173,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 48998,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21847040176391602,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49000,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21961727142333984,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49002,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22548479080200196,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49004,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2211836814880371,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49006,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22439935684204101,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49240,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) dummy)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2205081558227539,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49242,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21569536209106446,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49243,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) dummy))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21817312240600586,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49245,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2164019203186035,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49247,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.22053888320922851,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49249,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21821439743041993,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49251,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21870431900024415,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49429,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2223923110961914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49431,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21771263122558593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49432,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21829471588134766,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49434,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21737375259399414,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49601,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21552127838134766,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49603,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21007360458374025,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49605,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21322751998901368,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49727,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21883903503417967,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49729,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.21247936248779298,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 49731,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 0.2168409538269043,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52681,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6544869995117188,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52682,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6520806884765624,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52683,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6543128967285157,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52685,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6550297546386719,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52687,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6545887756347657,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52689,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6499404907226562,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52691,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6517427062988281,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52692,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6534425354003905,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52694,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.653043212890625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52695,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.65254150390625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52697,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6520089721679687,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52699,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.650133819580078,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52701,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) dummy))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6521318054199219,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52703,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6509336853027343,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52705,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6536166381835937,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52707,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6511386108398438,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 52709,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6516915893554687,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 53138,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6477593994140625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 53140,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6459571838378906,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 53141,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6503602600097655,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 53143,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6463052368164062,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 53145,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6472781372070313,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 53147,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6414703369140624,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 53149,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.646919708251953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 53482,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6489369201660156,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 53484,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6457923889160155,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 53485,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6508108520507812,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 53487,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6472883605957032,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 53826,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6978323364257812,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 53828,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6916172790527344,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 53830,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) dummy))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.697382354736328,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54165,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy)))))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6974029541015625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54167,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))))) (ploop 0 4096 128 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.691084747314453,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54169,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) dummy)))) (ploop 0 4096 128 n (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))",
    "execution_time_ms": 1.6965324401855468,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54714,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21893983840942383,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54715,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.218920955657959,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54717,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p dummy)))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21905248641967773,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54719,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2186342430114746,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54721,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21897216796875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54723,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p dummy))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21699583053588867,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54725,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21358591079711914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54727,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21393407821655275,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54729,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p dummy))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21560287475585938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54731,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21563392639160156,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54733,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21555200576782227,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54735,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (sloop 0 1040 tile_p p dummy)))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.20834304809570312,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54744,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2208358383178711,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54745,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22099967956542968,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54747,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p dummy))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22052864074707032,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54749,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2211020851135254,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54751,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22137855529785155,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54753,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p dummy)))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21833728790283202,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54760,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.216760311126709,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54762,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21626848220825196,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54764,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p dummy)))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21744640350341796,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54770,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21729280471801757,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54772,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21757951736450196,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54776,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (sloop 0 1040 tile_p p dummy))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.20917247772216796,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54812,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2210508728027344,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54813,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22149120330810546,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54815,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p dummy)))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22037504196166993,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54817,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2205183982849121,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54819,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2205695915222168,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54821,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p dummy))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21807104110717773,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54842,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21617664337158204,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54844,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21659648895263672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54846,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p dummy))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21713920593261718,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54864,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21765119552612305,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54866,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21692415237426757,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54878,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (sloop 0 1040 tile_p p dummy)))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.20954111099243164,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54983,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22173696517944336,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54984,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22218751907348633,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54986,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p dummy))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.221265926361084,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54988,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2213478469848633,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54990,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22039552688598632,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 54992,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p dummy)))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21823488235473631,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55040,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21622783660888673,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55042,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21725183486938476,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55044,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p dummy)))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21790719985961915,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55088,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21701631546020508,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55090,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21749759674072267,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55122,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (sloop 0 1040 tile_p p dummy))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.20962303161621093,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55384,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2211635208129883,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55385,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22212608337402343,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55387,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p dummy)))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22038496017456055,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55389,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2206399917602539,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55391,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22114303588867187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55393,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p dummy))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21790719985961915,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55487,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2163609504699707,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55489,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21625823974609376,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55491,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p dummy))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21738496780395508,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55585,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21782527923583983,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55587,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21770240783691405,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 55663,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (sloop 0 1040 tile_p p dummy)))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.20942848205566406,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 56804,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6470930480957031,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 56805,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6481382751464844,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 56807,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p dummy))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.654087677001953,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 56809,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6515072631835936,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 56811,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.652674560546875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 56813,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (sloop 0 1040 tile_p p dummy)))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.64384765625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 56982,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.647615966796875,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 56984,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6461106872558593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 56986,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (sloop 0 1040 tile_p p dummy)))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6504832458496095,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 57145,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))))) (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6449229431152343,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 57147,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))))) (seq (sloop 0 1040 tile_p p dummy) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6453836059570313,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 57324,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))))) (sloop 0 1040 tile_p p dummy))) (ploop 0 4096 128 n (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6898355102539062,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 57522,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6901734924316407,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 57524,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6889447021484374,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 57526,
    "ir_expression": "(seq (ploop 0 4096 128 n (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6877670288085938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 57912,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2089574432373047,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 57914,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2107801628112793,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 57916,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21297151565551758,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58518,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2097148895263672,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58520,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2105241584777832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58522,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2105241584777832,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58794,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.20969472885131835,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58796,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21135360717773438,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58798,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21056512832641602,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58908,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.20925439834594728,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58910,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21097471237182616,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58912,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21311487197875978,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58947,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.20922367095947267,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58949,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.20996095657348632,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58951,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2127872085571289,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58953,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21736448287963867,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58955,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21932031631469726,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58957,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21980159759521484,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58959,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22008832931518554,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58961,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22197248458862304,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58963,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22150144577026368,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58964,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2194838333129883,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58965,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22128639221191407,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58966,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22147071838378907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58968,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21961727142333984,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58970,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2210406494140625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58972,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22291456222534178,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58974,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21641216278076172,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58976,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21787647247314454,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58978,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21999616622924806,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58980,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21437440872192381,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58982,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21637119293212892,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58984,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21602144241333007,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58986,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21593088150024414,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58988,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21790719985961915,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 58990,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21808128356933593,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59004,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21790719985961915,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59006,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21974016189575196,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59008,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.222607364654541,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59010,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2207232093811035,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59012,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2218899154663086,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59014,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22371328353881836,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59015,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22122400283813476,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59016,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22225919723510743,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59017,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22452224731445314,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59019,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22040576934814454,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59021,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22192127227783204,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59023,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22383615493774414,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59034,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21700607299804686,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59036,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21888864517211915,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59038,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22035455703735352,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59040,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2165043258666992,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59042,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21784576416015625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59044,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21995487213134765,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59052,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21715967178344728,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59054,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2185932731628418,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59056,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2213478469848633,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59118,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21825536727905273,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59120,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21975040435791016,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59122,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22244352340698242,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59124,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22115327835083007,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59126,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2228531265258789,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59128,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22168575286865233,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59129,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22247423171997072,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59130,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22244352340698242,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59131,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22399999618530272,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59133,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22088703155517578,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59135,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22210559844970704,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59137,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2246246337890625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59172,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21722112655639647,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59174,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2184499168395996,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59176,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22052864074707032,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59178,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2165247917175293,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59180,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21831680297851563,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59182,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22009855270385742,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59208,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21731327056884767,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59210,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21900287628173828,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59212,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2206617546081543,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59397,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2187059211730957,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59399,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2196067237854004,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59401,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2228326416015625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59403,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22115327835083007,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59405,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22214527130126954,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59407,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22398975372314453,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59408,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22194175720214843,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59409,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22277120590209962,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59410,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2229350471496582,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59412,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22108160018920897,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59414,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22192127227783204,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59416,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22478847503662108,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59496,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2181939125061035,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59498,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21857280731201173,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59500,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21994495391845703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59502,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21712896347045899,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59504,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21767168045043944,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59506,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21968896865844725,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59568,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21772287368774415,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59570,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2190336036682129,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 59572,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21864383697509765,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60030,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2184499168395996,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60032,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22005760192871093,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60034,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.21963775634765625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60036,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22034303665161134,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60038,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2228425598144531,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60040,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2242969512939453,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60041,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.221910400390625,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60042,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22009632110595703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60043,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2230988883972168,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60045,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22144895553588867,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60047,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22182912826538087,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60049,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22439935684204101,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60204,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21699583053588867,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60206,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21854207992553712,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60208,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.22045696258544922,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60210,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21610496520996095,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60212,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21797887802124025,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60214,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2206208038330078,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60339,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21733375549316405,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60341,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21950464248657225,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 60343,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 0.2210201644897461,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62271,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6446669006347656,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62273,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6468479919433594,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62275,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6470016479492187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62277,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6525106811523438,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62279,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6552447509765624,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62281,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6561663818359376,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62282,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.648721923828125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62283,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6487423706054687,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62284,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6513945007324218,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62286,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6528175354003907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62288,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6525823974609375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62290,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p))))))))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (load (tensor C) (index (elem n) fulltile (tile p)))) 2)) (index (elem n) fulltile)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6565863037109374,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62565,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6497152709960938,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62567,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6516505432128907,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62569,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.65276611328125,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62571,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6465306091308594,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62573,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.649397735595703,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62575,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6516403198242187,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62805,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)))))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6458341979980469,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62807,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2)) (index (elem n) fulltile)))))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6453324890136718,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 62809,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor C_sum) (+ (rsum (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)))))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n))))))",
    "execution_time_ms": 1.6465811157226562,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63036,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21370880126953126,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63038,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21434303283691405,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63040,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21496831893920898,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63042,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22074367523193358,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63044,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.22131711959838868,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63046,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (store (tensor O) (+ (* (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2205081558227539,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63047,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.22011903762817384,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63048,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2212761688232422,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63049,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22035455703735352,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63051,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21604352951049804,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63053,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21715967178344728,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63055,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21708799362182618,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63060,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21729280471801757,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63062,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.21882879257202148,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63064,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2181222343444824,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63072,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21755903244018554,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63074,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2188083267211914,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63076,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21868543624877929,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63090,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.2173030471801758,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63092,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2186128044128418,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63094,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy dummy))) (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21805055618286132,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63117,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 0.21733375549316405,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63119,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 0.2184396743774414,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63121,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21799936294555664,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63189,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p dummy) (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))))",
    "execution_time_ms": 1.64527099609375,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63191,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq dummy (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))))",
    "execution_time_ms": 1.6487525939941405,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63193,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p)))))))))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (seq (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor O1) (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) (index fulltile (elem n) fulltile))))) (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6495616149902343,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63333,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile))) (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_div) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile (tile p))) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile (tile p)))) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22815744400024415,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63334,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile))) (seq (sloop 0 1040 tile_p p (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.22017887115478516,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63336,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2203647994995117,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63338,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (store (tensor C) (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1)) (index (elem n) fulltile (tile p)))) (seq (sloop 0 1040 tile_p p (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile (tile p)))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21774335861206054,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63340,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x 1 (load (tensor O) (index (elem n) fulltile fulltile))) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile)))))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.20907007217407225,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63344,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x (load (tensor C_sum) (index (elem n) fulltile)) 1) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.20960256576538086,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63352,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x (load (tensor C_sum) (index (elem n) fulltile)) 1)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.2100934410095215,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63371,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q2,K2,V2) (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (index fulltile (elem n) fulltile)) (seq (sloop 0 1040 tile_p p (seq (store (tensor Q,K,V) (permute3 (load (tensor Q2,K2,V2) (index fulltile (elem n) fulltile)) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (x 1 (load (tensor C_sum) (index (elem n) fulltile))) (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2)) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x 1 (load (tensor O) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile))))))))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.20960256576538086,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63415,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq (sloop 0 1040 tile_p p (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile))) (x (load (tensor O) (index (elem n) fulltile fulltile)) 1)) (index (elem n) fulltile fulltile)))))))))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile))))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 0.21013504028320312,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  },
  {
    "ir_id": 63597,
    "ir_expression": "(seq (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p (seq (sloop 0 4096 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq (store (tensor Q_norm,K_norm) (/ (load (tensor Q,K) (index (elem n) fulltile fulltile)) (bcast (sqrt (/ (rsum (sqr (load (tensor Q,K) (index (elem n) fulltile fulltile))) 2) 128)) 2)) (index (elem n) fulltile fulltile)) (seq (store (input K_cache,V_cache) (load (tensor K_norm,V) (index (elem n) fulltile fulltile)) (index (elem n) (const_tile 1024 16) fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q_norm) (index (elem n) fulltile fulltile)) (permute3 (load (input K_cache) (index (elem n) (tile p) fulltile)) 0 2 1))) (index (elem n) fulltile (tile p))) (seq (store (tensor C_sum) (+ (rsum (load (tensor C_exp) (index (elem n) fulltile (tile p))) 2) (x 1 (load (tensor C_sum) (index (elem n) fulltile)))) (index (elem n) fulltile)) (store (tensor O) (+ (x (load (tensor O) (index (elem n) fulltile fulltile)) 1) (* (load (tensor C_exp) (index (elem n) fulltile (tile p))) (load (input V_cache) (index (elem n) (tile p) fulltile)))) (index (elem n) fulltile fulltile))))))))))) (store (tensor O) (/ (load (tensor O) (index (elem n) fulltile fulltile)) (bcast (load (tensor C_sum) (index (elem n) fulltile)) 2)) (index (elem n) fulltile fulltile)))) (ploop 0 4096 128 n (seq (sloop 0 1040 tile_p p dummy) (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n)))))))",
    "execution_time_ms": 1.6920780944824219,
    "tensor_config": {
      "M": 16,
      "D": 128,
      "N": 4096,
      "P": 1024,
      "H": 32
    },
    "error": null
  }
]