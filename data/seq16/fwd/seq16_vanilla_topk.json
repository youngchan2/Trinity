[
  {
    "rank": 1,
    "ir_id": 0,
    "execution_time_ms": 0.43159358978271484,
    "tensor_config": {
      "M": 16,
      "D": 64,
      "N": 4544,
      "P": 1024,
      "H": 71
    },
    "ir_expression": "(ploop 0 4544 64 n (seq (sloop 0 4544 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (tensor K) (index (elem n) fulltile fulltile)) 0 2 1))) (index (elem n) fulltile fulltile)) (seq dummy (seq dummy (seq dummy (seq dummy (store (output O2) (squeeze (permute3 (* (/ (load (tensor C_exp) (index (elem n) fulltile fulltile)) (bcast (rsum (load (tensor C_exp) (index (elem n) fulltile fulltile)) 2) 2)) (load (tensor V) (index (elem n) fulltile fulltile))) 1 0 2) 1) (index fulltile (tile n)))))))))))))"
  },
  {
    "rank": 2,
    "ir_id": 9,
    "execution_time_ms": 0.433623046875,
    "tensor_config": {
      "M": 16,
      "D": 64,
      "N": 4544,
      "P": 1024,
      "H": 71
    },
    "ir_expression": "(seq (ploop 0 4544 64 n (seq (sloop 0 4544 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (tensor K) (index (elem n) fulltile fulltile)) 0 2 1))) (index (elem n) fulltile fulltile)) (seq dummy (seq dummy (store (tensor O) (* (/ (load (tensor C_exp) (index (elem n) fulltile fulltile)) (bcast (rsum (load (tensor C_exp) (index (elem n) fulltile fulltile)) 2) 2)) (load (tensor V) (index (elem n) fulltile fulltile))) (index (elem n) fulltile fulltile)))))))))) (ploop 0 4544 64 n (seq dummy (store (output O2) (squeeze (permute3 (load (tensor O) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))))))"
  },
  {
    "rank": 3,
    "ir_id": 10,
    "execution_time_ms": 0.43364288330078127,
    "tensor_config": {
      "M": 16,
      "D": 64,
      "N": 4544,
      "P": 1024,
      "H": 71
    },
    "ir_expression": "(seq (ploop 0 4544 64 n (seq (sloop 0 4544 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (tensor K) (index (elem n) fulltile fulltile)) 0 2 1))) (index (elem n) fulltile fulltile)) (seq dummy (seq dummy (seq dummy (store (tensor O1) (permute3 (* (/ (load (tensor C_exp) (index (elem n) fulltile fulltile)) (bcast (rsum (load (tensor C_exp) (index (elem n) fulltile fulltile)) 2) 2)) (load (tensor V) (index (elem n) fulltile fulltile))) 1 0 2) (index fulltile (elem n) fulltile))))))))))) (ploop 0 4544 64 n (store (output O2) (squeeze (load (tensor O1) (index fulltile (elem n) fulltile)) 1) (index fulltile (tile n)))))"
  },
  {
    "rank": 4,
    "ir_id": 8,
    "execution_time_ms": 0.4341862487792969,
    "tensor_config": {
      "M": 16,
      "D": 64,
      "N": 4544,
      "P": 1024,
      "H": 71
    },
    "ir_expression": "(seq (ploop 0 4544 64 n (seq (sloop 0 4544 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq dummy (seq (store (tensor C_exp) (exp (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (tensor K) (index (elem n) fulltile fulltile)) 0 2 1))) (index (elem n) fulltile fulltile)) (seq dummy (store (tensor C_div) (/ (load (tensor C_exp) (index (elem n) fulltile fulltile)) (bcast (rsum (load (tensor C_exp) (index (elem n) fulltile fulltile)) 2) 2)) (index (elem n) fulltile fulltile))))))))) (ploop 0 4544 64 n (seq dummy (seq dummy (store (output O2) (squeeze (permute3 (* (load (tensor C_div) (index (elem n) fulltile fulltile)) (load (tensor V) (index (elem n) fulltile fulltile))) 1 0 2) 1) (index fulltile (tile n)))))))"
  },
  {
    "rank": 5,
    "ir_id": 4,
    "execution_time_ms": 0.43425792694091797,
    "tensor_config": {
      "M": 16,
      "D": 64,
      "N": 4544,
      "P": 1024,
      "H": 71
    },
    "ir_expression": "(seq (ploop 0 4544 64 n (seq (sloop 0 4544 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq dummy (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (store (tensor C) (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (tensor K) (index (elem n) fulltile fulltile)) 0 2 1)) (index (elem n) fulltile fulltile)))))) (ploop 0 4544 64 n (seq (store (tensor C_exp) (exp (load (tensor C) (index (elem n) fulltile fulltile))) (index (elem n) fulltile fulltile)) (seq dummy (seq dummy (seq dummy (seq dummy (store (output O2) (squeeze (permute3 (* (/ (load (tensor C_exp) (index (elem n) fulltile fulltile)) (bcast (rsum (load (tensor C_exp) (index (elem n) fulltile fulltile)) 2) 2)) (load (tensor V) (index (elem n) fulltile fulltile))) 1 0 2) 1) (index fulltile (tile n))))))))))"
  }
]