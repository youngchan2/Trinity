[
  {
    "rank": 1,
    "ir_id": 15,
    "execution_time_ms": 0.7251148986816406,
    "tensor_config": {
      "M": 16,
      "D": 64,
      "N": 4544,
      "P": 1024,
      "H": 71
    },
    "ir_expression": "(ploop 0 4544 64 n (seq (sloop 0 4544 tile_k k (store (tensor Q1,K1,V1) (+ (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq dummy (seq (store (tensor dV) (* (permute3 (load (tensor C_div) (index (elem n) fulltile fulltile)) 0 2 1) (permute3 (unsqueeze (load (input dO2) (index fulltile (tile n))) 1) 1 0 2)) (index (elem n) fulltile fulltile)) (seq (store (tensor dC) (+ (load (tensor dC) (index (elem n) fulltile fulltile)) (x (load (tensor dC_exp) (index (elem n) fulltile fulltile)) (exp (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (tensor K) (index (elem n) fulltile fulltile)) 0 2 1))))) (index (elem n) fulltile fulltile)) (seq (store (tensor dQ) (+ (load (tensor dQ) (index (elem n) fulltile fulltile)) (* (load (tensor dC) (index (elem n) fulltile fulltile)) (load (tensor K) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq (store (tensor dK) (+ (* (permute3 (load (tensor dC) (index (elem n) fulltile fulltile)) 0 2 1) (load (tensor Q) (index (elem n) fulltile fulltile))) (load (tensor dK) (index (elem n) fulltile fulltile))) (index (elem n) fulltile fulltile)) (seq (sloop 0 4544 tile_k k (seq (store (tensor dQ1,dK1,dV1) (squeeze (permute3 (load (tensor dQ,dK,dV) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))) (store (output dWK) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dK1) (index fulltile (tile n)))) (index (tile k) (tile n))))) (seq (sloop 0 4544 tile_k k (store (output dWQ) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dQ1) (index fulltile (tile n)))) (index (tile k) (tile n)))) (sloop 0 4544 tile_k k (store (output dWV) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dV1) (index fulltile (tile n)))) (index (tile k) (tile n))))))))))))))"
  },
  {
    "rank": 2,
    "ir_id": 11,
    "execution_time_ms": 0.7255964660644532,
    "tensor_config": {
      "M": 16,
      "D": 64,
      "N": 4544,
      "P": 1024,
      "H": 71
    },
    "ir_expression": "(ploop 0 4544 64 n (seq (sloop 0 4544 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq dummy (seq (store (tensor dV) (* (permute3 (load (tensor C_div) (index (elem n) fulltile fulltile)) 0 2 1) (permute3 (unsqueeze (load (input dO2) (index fulltile (tile n))) 1) 1 0 2)) (index (elem n) fulltile fulltile)) (seq (store (tensor dC) (+ (x (exp (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (tensor K) (index (elem n) fulltile fulltile)) 0 2 1))) (load (tensor dC_exp) (index (elem n) fulltile fulltile))) (load (tensor dC) (index (elem n) fulltile fulltile))) (index (elem n) fulltile fulltile)) (seq (store (tensor dQ) (+ (load (tensor dQ) (index (elem n) fulltile fulltile)) (* (load (tensor dC) (index (elem n) fulltile fulltile)) (load (tensor K) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq (store (tensor dK) (+ (* (permute3 (load (tensor dC) (index (elem n) fulltile fulltile)) 0 2 1) (load (tensor Q) (index (elem n) fulltile fulltile))) (load (tensor dK) (index (elem n) fulltile fulltile))) (index (elem n) fulltile fulltile)) (seq (sloop 0 4544 tile_k k (seq (store (tensor dQ1,dK1,dV1) (squeeze (permute3 (load (tensor dQ,dK,dV) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))) (store (output dWQ) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dQ1) (index fulltile (tile n)))) (index (tile k) (tile n))))) (seq (sloop 0 4544 tile_k k (store (output dWK) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dK1) (index fulltile (tile n)))) (index (tile k) (tile n)))) (sloop 0 4544 tile_k k (store (output dWV) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dV1) (index fulltile (tile n)))) (index (tile k) (tile n))))))))))))))"
  },
  {
    "rank": 3,
    "ir_id": 7,
    "execution_time_ms": 0.7256883239746094,
    "tensor_config": {
      "M": 16,
      "D": 64,
      "N": 4544,
      "P": 1024,
      "H": 71
    },
    "ir_expression": "(ploop 0 4544 64 n (seq (sloop 0 4544 tile_k k (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n)))) (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq dummy (seq (store (tensor dV) (* (permute3 (load (tensor C_div) (index (elem n) fulltile fulltile)) 0 2 1) (permute3 (unsqueeze (load (input dO2) (index fulltile (tile n))) 1) 1 0 2)) (index (elem n) fulltile fulltile)) (seq (store (tensor dC) (+ (load (tensor dC) (index (elem n) fulltile fulltile)) (x (load (tensor dC_exp) (index (elem n) fulltile fulltile)) (exp (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (tensor K) (index (elem n) fulltile fulltile)) 0 2 1))))) (index (elem n) fulltile fulltile)) (seq (store (tensor dQ) (+ (load (tensor dQ) (index (elem n) fulltile fulltile)) (* (load (tensor dC) (index (elem n) fulltile fulltile)) (load (tensor K) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq (store (tensor dK) (+ (* (permute3 (load (tensor dC) (index (elem n) fulltile fulltile)) 0 2 1) (load (tensor Q) (index (elem n) fulltile fulltile))) (load (tensor dK) (index (elem n) fulltile fulltile))) (index (elem n) fulltile fulltile)) (seq (store (tensor dQ1,dK1,dV1) (squeeze (permute3 (load (tensor dQ,dK,dV) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))) (seq (sloop 0 4544 tile_k k (store (output dWQ) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dQ1) (index fulltile (tile n)))) (index (tile k) (tile n)))) (seq (sloop 0 4544 tile_k k (store (output dWK) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dK1) (index fulltile (tile n)))) (index (tile k) (tile n)))) (sloop 0 4544 tile_k k (store (output dWV) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dV1) (index fulltile (tile n)))) (index (tile k) (tile n)))))))))))))))"
  },
  {
    "rank": 4,
    "ir_id": 23,
    "execution_time_ms": 0.7258624267578125,
    "tensor_config": {
      "M": 16,
      "D": 64,
      "N": 4544,
      "P": 1024,
      "H": 71
    },
    "ir_expression": "(ploop 0 4544 64 n (seq (sloop 0 4544 tile_k k (store (tensor Q1,K1,V1) (+ (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n)))) (x (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1)) (index fulltile (tile n)))) (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq dummy (seq (store (tensor dV) (* (permute3 (load (tensor C_div) (index (elem n) fulltile fulltile)) 0 2 1) (permute3 (unsqueeze (load (input dO2) (index fulltile (tile n))) 1) 1 0 2)) (index (elem n) fulltile fulltile)) (seq (store (tensor dC) (+ (load (tensor dC) (index (elem n) fulltile fulltile)) (x (exp (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (tensor K) (index (elem n) fulltile fulltile)) 0 2 1))) (load (tensor dC_exp) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq (store (tensor dQ) (+ (load (tensor dQ) (index (elem n) fulltile fulltile)) (* (load (tensor dC) (index (elem n) fulltile fulltile)) (load (tensor K) (index (elem n) fulltile fulltile)))) (index (elem n) fulltile fulltile)) (seq (store (tensor dK) (+ (* (permute3 (load (tensor dC) (index (elem n) fulltile fulltile)) 0 2 1) (load (tensor Q) (index (elem n) fulltile fulltile))) (load (tensor dK) (index (elem n) fulltile fulltile))) (index (elem n) fulltile fulltile)) (seq (sloop 0 4544 tile_k k (seq (store (tensor dQ1,dK1,dV1) (squeeze (permute3 (load (tensor dQ,dK,dV) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))) (store (output dWV) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dV1) (index fulltile (tile n)))) (index (tile k) (tile n))))) (seq (sloop 0 4544 tile_k k (store (output dWQ) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dQ1) (index fulltile (tile n)))) (index (tile k) (tile n)))) (sloop 0 4544 tile_k k (store (output dWK) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dK1) (index fulltile (tile n)))) (index (tile k) (tile n))))))))))))))"
  },
  {
    "rank": 5,
    "ir_id": 49,
    "execution_time_ms": 0.7269273376464844,
    "tensor_config": {
      "M": 16,
      "D": 64,
      "N": 4544,
      "P": 1024,
      "H": 71
    },
    "ir_expression": "(ploop 0 4544 64 n (seq (sloop 0 4544 tile_k k (seq (store (tensor Q1,K1,V1) (+ (x 1 (load (tensor Q1,K1,V1) (index fulltile (tile n)))) (* (load (input X) (index fulltile (tile k))) (load (input WQ,WK,WV) (index (tile k) (tile n))))) (index fulltile (tile n))) (store (tensor dV) (* (permute3 (load (tensor C_div) (index (elem n) fulltile fulltile)) 0 2 1) (permute3 (unsqueeze (load (input dO2) (index fulltile (tile n))) 1) 1 0 2)) (index (elem n) fulltile fulltile)))) (seq (store (tensor Q,K,V) (permute3 (unsqueeze (load (tensor Q1,K1,V1) (index fulltile (tile n))) 1) 1 0 2) (index (elem n) fulltile fulltile)) (seq dummy (seq (store (tensor dC) (+ (x (exp (* (load (tensor Q) (index (elem n) fulltile fulltile)) (permute3 (load (tensor K) (index (elem n) fulltile fulltile)) 0 2 1))) (load (tensor dC_exp) (index (elem n) fulltile fulltile))) (load (tensor dC) (index (elem n) fulltile fulltile))) (index (elem n) fulltile fulltile)) (seq (store (tensor dQ) (+ (* (load (tensor dC) (index (elem n) fulltile fulltile)) (load (tensor K) (index (elem n) fulltile fulltile))) (load (tensor dQ) (index (elem n) fulltile fulltile))) (index (elem n) fulltile fulltile)) (seq (store (tensor dK) (+ (* (permute3 (load (tensor dC) (index (elem n) fulltile fulltile)) 0 2 1) (load (tensor Q) (index (elem n) fulltile fulltile))) (load (tensor dK) (index (elem n) fulltile fulltile))) (index (elem n) fulltile fulltile)) (seq (sloop 0 4544 tile_k k (seq (store (tensor dQ1,dK1,dV1) (squeeze (permute3 (load (tensor dQ,dK,dV) (index (elem n) fulltile fulltile)) 1 0 2) 1) (index fulltile (tile n))) (store (output dWV) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dV1) (index fulltile (tile n)))) (index (tile k) (tile n))))) (seq (sloop 0 4544 tile_k k (store (output dWQ) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dQ1) (index fulltile (tile n)))) (index (tile k) (tile n)))) (sloop 0 4544 tile_k k (store (output dWK) (* (transpose (load (input X) (index fulltile (tile k)))) (load (tensor dK1) (index fulltile (tile n)))) (index (tile k) (tile n)))))))))))))"
  }
]